<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>NX-BOOK</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="nxnsf-the-definitive-guide">NX/NSF: The Definitive Guide</h1>
<h2 id="introduction">Introduction</h2>
<p>NX/NSF (Next Scripting Framework) is a Tcl-based object-oriented
programming system that provides advanced capabilities for building
complex applications. This guide serves as a comprehensive reference for
NX/NSF programming.</p>
<h3 id="historical-context">Historical Context</h3>
<p>While NX has predecessors in the Tcl ecosystem (XOTcl and XOTcl2), it
is a distinct and improved language with its own features and design
philosophy. Key points about NX’s position in the Tcl ecosystem:</p>
<ul>
<li><strong>Foundation</strong>: Built on Tcl (requires Tcl 8.5 or
newer)</li>
<li><strong>Framework</strong>: Part of the Next Scripting Framework
(NSF)</li>
<li><strong>Design Goals</strong>:
<ul>
<li>Easier learning curve for novices</li>
<li>Improved maintainability</li>
<li>Better structured programs</li>
<li>Enhanced support for large projects</li>
<li>Language-oriented programming support</li>
</ul></li>
</ul>
<h3 id="key-differentiators">Key Differentiators</h3>
<p>NX differs from its predecessors in several important ways: - More
mainstream terminology - Higher orthogonality of methods - Fewer
predefined methods - Strong focus on maintainability - Built-in support
for interfaces - Language-oriented programming capabilities</p>
<h2 id="core-packages-and-base-classes">Core Packages and Base
Classes</h2>
<p>The foundation of NX/NSF begins with its core packages:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> nsf     # Next Scripting Framework</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> nx      # NX object <span class="ot">system</span></span></code></pre></div>
<p>The system is built on two fundamental base classes: -
<code>nx::Object</code>: The base object class for all objects in the
system - <code>nx::Class</code>: The metaclass for creating classes
(which is an instance of itself)</p>
<p>These base classes provide the essential functionality for object
creation, method dispatch, and property management. The system ensures
safety by protecting these base classes from accidental deletion or
modification.</p>
<h3 id="tcl-interpreter-integration">Tcl Interpreter Integration</h3>
<p>NX/NSF provides robust integration with Tcl’s interpreter system,
allowing for sophisticated control over command visibility and
interpreter management. This section covers the essential aspects of
working with Tcl interpreters in NX/NSF applications.</p>
<h4 id="basic-interpreter-operations">Basic Interpreter Operations</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new slave interpreter</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> <span class="ot">create</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new interpreter with NSF loaded</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>::nsf::<span class="kw">interp</span> <span class="ot">create</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new safe interpreter with NSF loaded</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>::nsf::<span class="kw">interp</span> <span class="ot">create -safe</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate commands in a slave interpreter</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="kw">eval</span> <span class="kw">{</span>cmd<span class="kw">}</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Destroy an interpreter</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> <span class="ot">delete</span> <span class="dt">$i</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if interpreter is safe</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> issafe <span class="dt">$i</span></span></code></pre></div>
<h4 id="command-hiding-and-exposure">Command Hiding and Exposure</h4>
<p>NX/NSF provides mechanisms to control command visibility in
interpreters:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide a command in the interpreter</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="ot">hide</span> cmdName</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide a command under a different name</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="ot">hide</span> cmdName newName</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-expose a hidden command</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> expose <span class="dt">$i</span> hiddenCmd</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-expose a hidden command under a different name</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> expose <span class="dt">$i</span> hiddenCmd newName</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># List all hidden commands</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> hidden <span class="dt">$i</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Invoke a hidden command</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> invokehidden <span class="dt">$i</span> cmd <span class="ot">args</span></span></code></pre></div>
<h4 id="hidden-command-characteristics">Hidden Command
Characteristics</h4>
<p>Hidden commands in NX/NSF have specific behaviors and
limitations:</p>
<ol type="1">
<li><strong>Storage and Access</strong>:
<ul>
<li>Removed from normal command table</li>
<li>Placed in separate interpreter-wide hash table</li>
<li>Cannot be accessed via normal command invocation</li>
<li>Cannot use namespace qualifiers when hiding commands</li>
<li>Command structure is preserved internally</li>
<li>Object system relationships remain intact</li>
</ul></li>
<li><strong>Limitations</strong>:
<ul>
<li>Cannot hide namespace-qualified commands</li>
<li>Cannot directly dispatch to hidden commands</li>
<li>Hidden commands are cleaned up later than regular commands during
interpreter deletion</li>
</ul></li>
</ol>
<h4 id="object-system-interaction">Object System Interaction</h4>
<p>When working with hidden commands in NX/NSF:</p>
<ol type="1">
<li><strong>Object Structure Preservation</strong>:
<ul>
<li>Object instances remain in the object system</li>
<li>Object-class relationships are maintained</li>
<li>Mixin relationships are preserved</li>
<li>Introspection still functions for pattern-based queries</li>
</ul></li>
<li><strong>Method Dispatch</strong>:
<ul>
<li>Hidden objects can still be accessed via their instances</li>
<li>Methods from hidden classes still function on instances</li>
<li>Existing mixin relationships continue to work</li>
</ul></li>
<li><strong>Alias Handling</strong>:
<ul>
<li>Aliases to hidden procs/objects cannot be dispatched</li>
<li>Re-exposing with original name restores alias functionality</li>
<li>Re-exposing with a different name does not automatically restore
alias</li>
<li>The <code>::nsf::alias</code> array can be manually modified to fix
aliases</li>
</ul></li>
</ol>
<h4 id="object-system-cleanup">Object System Cleanup</h4>
<div class="sourceCode" id="cb4"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shut down NSF object system in an interpreter</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nsf::finalize <span class="kw">[</span>-keepvars<span class="kw">]</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The -keepvars flag preserves global variables</span></span></code></pre></div>
<h4 id="destruction-behavior">Destruction Behavior</h4>
<ol type="1">
<li><strong>Normal Destruction</strong>:
<ul>
<li>Object destructors are called during cleanup</li>
<li>Hidden commands are processed after exit handlers</li>
</ul></li>
<li><strong>Explicit Destruction</strong>:
<ul>
<li>Hidden objects can be destroyed via
<code>interp invokehidden</code></li>
<li>After destruction, object is removed from hidden command table</li>
</ul></li>
<li><strong>Error Handling in Destroy</strong>:
<ul>
<li>Errors in destroy methods don’t prevent cleanup</li>
<li>Self-deletion or self-hiding in destroy methods requires careful
handling</li>
</ul></li>
</ol>
<h4 id="mixin-relationships">Mixin Relationships</h4>
<p>When working with hidden commands and mixins:</p>
<ol type="1">
<li>Existing mixins continue to function when commands are hidden</li>
<li>Adding/removing mixins involving hidden classes is problematic</li>
<li>Mixin order computation handles hidden mixins properly</li>
</ol>
<h4 id="best-practices">Best Practices</h4>
<ol type="1">
<li><strong>When Working with Hidden Commands</strong>:
<ul>
<li>Use <code>interp invokehidden</code> from the master
interpreter</li>
<li>Don’t rely on aliases to hidden commands</li>
<li>Be careful with destructors that modify command visibility</li>
</ul></li>
<li><strong>For Cleanup</strong>:
<ul>
<li>Use <code>nsf::finalize</code> for controlled shutdown</li>
<li>Check hidden commands after cleanup with
<code>interp hidden</code></li>
</ul></li>
</ol>
<h4 id="example-hide-and-re-expose">Example: Hide and Re-expose</h4>
<div class="sourceCode" id="cb5"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and hide a command</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> i <span class="kw">[interp</span> <span class="ot">create</span><span class="kw">]</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="kw">eval</span> <span class="kw">{</span>nx::Object <span class="ot">create</span> ::o<span class="kw">}</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="ot">hide</span> o</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check status</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> hidden <span class="dt">$i</span>         # Returns <span class="st">&quot;o&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="dt">$i</span> <span class="kw">eval</span> <span class="kw">{info</span> <span class="ot">commands</span> ::o<span class="kw">}</span>  # Returns <span class="st">&quot;&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Access via hidden mechanism</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> invokehidden <span class="dt">$i</span> o method <span class="ot">args</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-expose the command</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> expose <span class="dt">$i</span> o</span></code></pre></div>
<h3 id="internationalization-and-message-handling">Internationalization
and Message Handling</h3>
<p>NX/NSF provides robust support for internationalization through
integration with Tcl’s msgcat package. This allows for easy localization
of messages and text in NX applications.</p>
<h4 id="basic-usage">Basic Usage</h4>
<div class="sourceCode" id="cb6"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the msgcat package</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> req msgcat</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set messages in the current locale</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>::msgcat::mcset <span class="kw">[</span>::msgcat::mclocale<span class="kw">]</span> message_key <span class="st">&quot;message text&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example with namespace context</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>::msgcat::mcset <span class="kw">[</span>::msgcat::mclocale<span class="kw">]</span> m1 <span class="st">&quot;[namespace current] message1&quot;</span></span></code></pre></div>
<h4 id="accessing-messages">Accessing Messages</h4>
<div class="sourceCode" id="cb7"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import mc command for easier access</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> import ::msgcat::mc</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve a message</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mc message_key</span></code></pre></div>
<h4 id="namespace-behavior">Namespace Behavior</h4>
<p>The msgcat package respects Tcl namespaces when looking up
messages:</p>
<ol type="1">
<li>Messages are first looked up in the current namespace</li>
<li>If not found, msgcat looks in parent namespaces</li>
<li>Finally falls back to the global namespace</li>
</ol>
<p>Example namespace structure:</p>
<pre><code>::              (global)
  ↓
::foo           (child namespace)
  ↓
::foo::bar      (grandchild namespace)</code></pre>
<h4 id="integration-with-nxnsf-classes">Integration with NX/NSF
Classes</h4>
<p>Within nx::Class definitions, msgcat can be used in various
contexts:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ClassName <span class="kw">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">require</span> <span class="kw">namespace</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using mc in class definition</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  ? <span class="kw">[list</span> <span class="kw">set</span> _ <span class="kw">[</span>mc message_key<span class="kw">]]</span> <span class="dt">$expected_value</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using mc in instance methods</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  :public method methodName <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="kw">[</span>mc message_key<span class="kw">]</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using mc in object methods</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  :public object method methodName <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="kw">[</span>mc message_key<span class="kw">]</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using mc in property accessors</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  :property propName <span class="kw">{</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    :public object method value=<span class="ot">get</span> <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="kw">return</span> <span class="kw">[namespace</span> <span class="ot">current</span><span class="kw">]</span>-<span class="kw">[</span>mc message_key<span class="kw">]</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="custom-property-behavior-with-msgcat">Custom Property Behavior
with Msgcat</h4>
<p>Properties can be enhanced with msgcat integration:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> public propName <span class="kw">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  :public object method value=<span class="kw">set</span> <span class="kw">{</span>obj prop value<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ::msgcat::mcset <span class="kw">[</span>::msgcat::mclocale<span class="kw">]</span> <span class="dt">$value</span> <span class="st">&quot;new message&quot;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    next</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  :public object method value=<span class="ot">get</span> <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    mc <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="testing-message-resolution">Testing Message Resolution</h4>
<p>Message resolution can be tested using various methods:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test instance method result</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{[</span>::Namespace::ClassName new<span class="kw">]</span> methodName<span class="kw">}</span> <span class="dt">$expected_value</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test object method result</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>::Namespace::ClassName methodName<span class="kw">}</span> <span class="dt">$expected_value</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Test property access</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{[</span>::Namespace::ClassName new<span class="kw">]</span> <span class="ot">cget -propName</span><span class="kw">}</span> <span class="dt">$expected_value</span></span></code></pre></div>
<h4 id="key-concepts">Key Concepts</h4>
<ol type="1">
<li><strong>Namespace Awareness</strong>: Messages are bound to their
defining namespace</li>
<li><strong>Locale Management</strong>: <code>::msgcat::mclocale</code>
returns or sets the current locale</li>
<li><strong>Message Setting</strong>: <code>::msgcat::mcset</code>
associates a key with a message in a locale</li>
<li><strong>Message Retrieval</strong>: <code>::msgcat::mc</code> (or
imported <code>mc</code>) retrieves messages based on context</li>
<li><strong>Inheritance</strong>: Messages cascade from child to parent
namespaces</li>
</ol>
<h3 id="mixins">Mixins</h3>
<p>Mixins are a powerful feature in NX that allows you to add
functionality to classes or objects without using inheritance. A mixin
is a class that is mixed into another class or object to provide
additional functionality.</p>
<h4 id="basic-concepts">Basic Concepts</h4>
<ul>
<li><strong>Mixin</strong>: A class that is mixed into another class or
object to provide additional functionality</li>
<li><strong>Per-Object Mixin</strong>: A mixin applied to a specific
object instance</li>
<li><strong>Per-Class Mixin</strong>: A mixin applied to a class,
affecting all instances of that class</li>
</ul>
<h4 id="setting-mixins">Setting Mixins</h4>
<div class="sourceCode" id="cb12"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply per-object mixin</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj<span class="ot"> -object</span>-mixins MixinClass</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply per-class mixin</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MyClass<span class="ot"> -mixin</span> MixinClass</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set mixin on existing class</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>MyClass mixins <span class="kw">set</span> MixinClass</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add guard to mixin</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>MyClass mixins guard MixinClass <span class="st">&quot;guardCondition&quot;</span></span></code></pre></div>
<h4 id="querying-mixins">Querying Mixins</h4>
<div class="sourceCode" id="cb13"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get mixins for an object</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>obj object mixins <span class="ot">get</span>        # Returns <span class="kw">list</span> of object mixins</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object mixins       # Alternative syntax</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get mixins for a class</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>MyClass mixins <span class="ot">get</span>           # Returns <span class="kw">list</span> of <span class="ot">class</span> mixins</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>MyClass <span class="kw">info</span> mixins          # Alternative syntax</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>MyClass <span class="kw">info</span> mixins<span class="ot"> -guards</span>  # Show mixins with guards</span></code></pre></div>
<h4 id="finding-where-a-class-is-mixed-in">Finding Where a Class is
Mixed In</h4>
<div class="sourceCode" id="cb14"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic usage</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof              # Shows where MixinClass <span class="ot">is</span> mixed in</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scope options</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof<span class="ot"> -scope</span> <span class="ot">class</span>  # Only <span class="ot">class</span>-<span class="ot">level</span> mixins</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof<span class="ot"> -scope</span> object # Only object-<span class="ot">level</span> mixins</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof<span class="ot"> -scope</span> all    # Both <span class="ot">class</span> and object <span class="ot">level</span> (<span class="ot">default</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Transitive closure options</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof<span class="ot"> -closure</span>      # Includes indirect mixinof relationships</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>MixinClass <span class="kw">info</span> mixinof<span class="ot"> -closure</span> pattern  # Filter with <span class="kw">glob</span> pattern</span></code></pre></div>
<h4 id="method-precedence">Method Precedence</h4>
<p>When an object has mixins, method calls use the following precedence
order:</p>
<ol type="1">
<li>Per-object mixins</li>
<li>Class of the object</li>
<li>Per-class mixins of the object’s class</li>
<li>Superclasses (in inheritance order)</li>
<li>nx::Object (base class)</li>
</ol>
<p>Example precedence:
<code>::MixinClass ::MyClass ::nx::Object</code></p>
<h4 id="mixin-inheritance-behavior">Mixin Inheritance Behavior</h4>
<ul>
<li>Mixins from superclasses are inherited by subclasses
(transitive)</li>
<li>When a class used as a mixin has its own mixins, those are included
in the precedence chain</li>
<li>Destroying a mixin class removes it from all objects and
classes</li>
</ul>
<h4 id="recreating-classes-with-mixins">Recreating Classes with
Mixins</h4>
<h5 id="with-softrecreate-false-default">With softrecreate = false
(default)</h5>
<p>When recreating a class that is used as a mixin: - All mixin
relationships are lost - Subclass relationships are broken - Objects of
the old class become instances of nx::Object</p>
<h5 id="with-softrecreate-true">With softrecreate = true</h5>
<p>When recreating a class that is used as a mixin: - Mixin
relationships are preserved - Subclass relationships are maintained -
Objects remain instances of their classes</p>
<h4 id="common-patterns-and-examples">Common Patterns and Examples</h4>
<h5 id="per-object-mixins">Per-Object Mixins</h5>
<div class="sourceCode" id="cb15"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Logger <span class="kw">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    :method log <span class="kw">{</span>msg<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;LOG: </span><span class="dt">$</span><span class="st">msg&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        next</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> myObj<span class="ot"> -object</span>-mixins Logger</span></code></pre></div>
<h5 id="per-class-mixins">Per-Class Mixins</h5>
<div class="sourceCode" id="cb16"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Auditable <span class="kw">{</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    :method save <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;Auditing save operation&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        next</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Document<span class="ot"> -mixin</span> Auditable</span></code></pre></div>
<h5 id="complex-precedence-example">Complex Precedence Example</h5>
<div class="sourceCode" id="cb17"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> A</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> B<span class="ot"> -mixin</span> A</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> C<span class="ot"> -superclass</span> B</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>C <span class="ot">create</span> c1</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># c1&#39;s precedence: ::A ::C ::B ::nx::Object</span></span></code></pre></div>
<h3 id="variable-and-parameter-information">Variable and Parameter
Information</h3>
<p>The NX/NSF system provides comprehensive introspection capabilities
for variables and parameters. This section covers the essential commands
and patterns for working with class and object variables.</p>
<h4 id="class-information-commands">Class Information Commands</h4>
<div class="sourceCode" id="cb18"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of parameters for class creation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>/cls/ <span class="kw">info</span> <span class="ot">configure</span> parameters ?pattern?</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get syntax output for class creation</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>/cls/ <span class="kw">info</span> <span class="ot">configure</span> syntax</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get method parameters</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>/cls/ <span class="kw">info</span> method parameters /methodname/ ?/pattern/?</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get method syntax</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>/cls/ <span class="kw">info</span> method syntax /methodname/</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable handles</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>/cls/ <span class="kw">info</span> variables ?/pattern/?</span></code></pre></div>
<h4 id="object-information">Object Information</h4>
<div class="sourceCode" id="cb19"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get object method parameters</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> object method parameters /methodname/ ?/pattern/?</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get object method syntax</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> object method syntax /methodname/</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get object variable handles</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> object variables ?/pattern/?</span></code></pre></div>
<h4 id="lookup-information">Lookup Information</h4>
<div class="sourceCode" id="cb20"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameters from class hierarchy</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> lookup <span class="ot">configure</span> parameters ?/pattern/?</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get syntax from class hierarchy</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> lookup <span class="ot">configure</span> syntax</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable handles from class hierarchy</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> lookup variables ?/pattern/?</span></code></pre></div>
<h4 id="context-free-operations">Context-free Operations</h4>
<div class="sourceCode" id="cb21"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Work on any object (does not need object)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> parameter <span class="kw">list</span>|<span class="ot">name</span>|syntax /param/</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>/obj/ <span class="kw">info</span> <span class="kw">variable</span> definition|<span class="ot">name</span>|parameter /<span class="ot">handle</span>/</span></code></pre></div>
<h4 id="parameter-handling-with-nsfparameterinfo">Parameter Handling
with <code>nsf::parameter::info</code></h4>
<div class="sourceCode" id="cb22"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter syntax representation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> syntax parameter_definition</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter name</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">name</span> parameter_definition</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if parameter has default value</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">default</span> parameter_definition ?varname?</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameter type</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">type</span> parameter_definition</span></code></pre></div>
<p>Examples:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> syntax age:integer         # Returns: <span class="st">&quot;/age/&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> syntax<span class="ot"> -force</span>:<span class="kw">switch</span>       # Returns: <span class="st">&quot;?-force?&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">name</span> <span class="st">&quot;a b&quot;</span>                 # Returns: <span class="st">&quot;a&quot;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">default</span> <span class="st">&quot;b:integer 123&quot;</span>    # Returns: <span class="dv">1</span> (has <span class="ot">default</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>nsf::parameter::<span class="kw">info</span> <span class="ot">type</span> <span class="st">&quot;age:integer&quot;</span>         # Returns: <span class="st">&quot;integer&quot;</span></span></code></pre></div>
<h4 id="variable-and-property-definition-examples">Variable and Property
Definition Examples</h4>
<h5 id="class-level-properties-and-variables">Class Level Properties and
Variables</h5>
<div class="sourceCode" id="cb24"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic property</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>:property <span class="ot">name</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Typed property</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>:property age:integer</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Property with default value</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>b:integer <span class="dv">123</span><span class="kw">}</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable with default value</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>:<span class="kw">variable</span> c <span class="dv">456</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Typed variable with default</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>:<span class="kw">variable</span> d:<span class="kw">lower</span> abc</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Public accessor</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>:<span class="kw">variable</span><span class="ot"> -accessor</span> public e:<span class="kw">lower</span> efg</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Private accessor</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> private <span class="kw">{</span>p <span class="dv">19</span><span class="kw">}</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Protected accessor</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> protected q</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Incremental property</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -incremental</span> i</span></code></pre></div>
<h5 id="object-level-properties-and-variables">Object Level Properties
and Variables</h5>
<div class="sourceCode" id="cb25"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Object property</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>:object property oa:integer</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Object property with default</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>:object property <span class="kw">{</span>ob:integer <span class="dv">123</span><span class="kw">}</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Object variable</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>:object <span class="kw">variable</span> oc <span class="dv">456</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Object variable with type</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>:object <span class="kw">variable</span> od:<span class="kw">lower</span> abc</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Public object variable</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>:object <span class="kw">variable</span><span class="ot"> -accessor</span> public oe:<span class="kw">lower</span> efg</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Incremental object property</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -incremental</span> oi</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Private object property</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> private <span class="kw">{</span>op <span class="dv">19</span><span class="kw">}</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Protected object property</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> protected oq</span></code></pre></div>
<h4 id="slot-and-variable-information">Slot and Variable
Information</h4>
<div class="sourceCode" id="cb26"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all slots</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> slots</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get specific slot</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> slots p</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get slot definition</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>::Foo::slot::b definition</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># List all variables</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> variables</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># List specific variable</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> variables p</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable definition</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> <span class="kw">variable</span> definition <span class="ot">handle</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable parameter</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> <span class="kw">variable</span> parameter <span class="ot">handle</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable name</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>::Foo <span class="kw">info</span> <span class="kw">variable</span> <span class="ot">name</span> <span class="ot">handle</span></span></code></pre></div>
<h4 id="lookup-variables">Lookup Variables</h4>
<div class="sourceCode" id="cb27"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get count of lookup variables</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">llength</span> <span class="kw">[</span>::f1 <span class="kw">info</span> lookup variables<span class="kw">]</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List all lookup variables (includes inherited)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>::f1 <span class="kw">info</span> lookup variables</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for specific lookup variables</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>::f1 <span class="kw">info</span> lookup variables p</span></code></pre></div>
<h4 id="accessor-usage-patterns">Accessor Usage Patterns</h4>
<div class="sourceCode" id="cb28"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Private and protected access via method</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>:public method m <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> p <span class="ot">get</span><span class="kw">}</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Object-level private property access</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>:public object method om <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> p<span class="kw">}</span></span></code></pre></div>
<h4 id="variable-naming-notes">Variable Naming Notes</h4>
<ul>
<li>Private properties are prefixed with <code>____ClassName</code> in
slot names</li>
<li>Per-object variables use <code>per-object-slot</code> namespace</li>
<li>Private properties in name output appear as
<code>__private(namespace,name)</code></li>
</ul>
<h3 id="info-method-commands">Info Method Commands</h3>
<p>The NX/NSF system provides comprehensive introspection capabilities
through its info method commands. These commands allow you to inspect
and query various aspects of objects and classes.</p>
<h4 id="basic-info-commands">Basic Info Commands</h4>
<div class="sourceCode" id="cb29"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Superclass Information</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> superclasses                   # Get direct superclasses</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> superclasses<span class="ot"> -closure</span>          # Get all superclasses (including indirect)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> superclasses pattern           # Get superclasses matching pattern</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> superclasses<span class="ot"> -closure</span> pattern  # Get all superclasses matching pattern</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Heritage and Precedence</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> heritage                       # Get <span class="ot">class</span> inheritance path</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> precedence                     # Get method dispatch order</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> precedence pattern             # Get method dispatch order matching pattern</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Method Information</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods                        # List methods</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -callprotection</span> all    # List all methods (including protected)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -type</span> scripted         # List only scripted methods</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -path</span>                  # List methods as path <span class="ot">names</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -closure</span> pattern       # List all methods (including inherited) matching pattern</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -source</span> application    # List only application-defined methods</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> methods<span class="ot"> -source</span> <span class="ot">system</span>         # List only <span class="ot">system</span> methods</span></code></pre></div>
<h4 id="method-lookup-and-details">Method Lookup and Details</h4>
<div class="sourceCode" id="cb30"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method Lookup</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> lookup method <span class="ot">name</span>             # Get <span class="ot">actual</span> method to be called <span class="kw">for</span> <span class="ot">name</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> lookup methods pattern         # List available methods matching pattern</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> lookup methods<span class="ot"> -path</span> pattern   # List methods with ensemble paths</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> lookup methods<span class="ot"> -source</span> all     # List all available methods</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Method Details</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method definition <span class="ot">name</span>         # Get method definition</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method returns <span class="ot">name</span>            # Get <span class="kw">return</span> <span class="ot">type</span> constraint</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method parameters <span class="ot">name</span>         # Get parameter definitions</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method syntax <span class="ot">name</span>             # Get syntax documentation</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method <span class="ot">exists</span> <span class="ot">name</span>             # Check <span class="kw">if</span> method <span class="ot">exists</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method <span class="ot">type</span> <span class="ot">name</span>               # Get method <span class="ot">type</span></span></code></pre></div>
<h4 id="object-methods-and-properties">Object Methods and
Properties</h4>
<div class="sourceCode" id="cb31"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Object Methods</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object methods                 # List object methods</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object method definition <span class="ot">name</span>  # Get object method definition</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object method parameters <span class="ot">name</span>  # Get object method parameters</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object method returns <span class="ot">name</span>     # Get object method <span class="kw">return</span> <span class="ot">type</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object method submethods <span class="ot">name</span>  # List submethods of ensemble</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Slots (Properties)</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> slots                          # List slots</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> slots<span class="ot"> -closure</span>                 # List all slots (including inherited)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> slots<span class="ot"> -closure -source</span> application # List application-defined slots</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> slots pattern                  # List slots matching pattern</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object slots                   # List object-specific slots</span></code></pre></div>
<h4 id="mixins-and-filters">Mixins and Filters</h4>
<div class="sourceCode" id="cb32"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixins</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> mixins                         # List direct mixins</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> mixins<span class="ot"> -closure</span>                # List all transitive mixins</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> mixins<span class="ot"> -heritage</span>               # List explicit and implicit mixins</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object mixins                  # List object mixins</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object mixins<span class="ot"> -guards</span>          # List object mixins with guards</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object mixins<span class="ot"> -guards</span> <span class="ot">name</span>     # Get guard <span class="kw">for</span> specific mixin</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filters</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> filters                        # List filters</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> filters<span class="ot"> -guards</span>                # List filters with their guards</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object filters                 # List object filters</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object filters<span class="ot"> -guards</span>         # List object filters with guards</span></code></pre></div>
<h4 id="ensemble-methods">Ensemble Methods</h4>
<div class="sourceCode" id="cb33"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble Method Information</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method submethods ensemble     # List submethods of ensemble</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method <span class="ot">exists</span> <span class="st">&quot;ensemble submethod&quot;</span> # Check <span class="kw">if</span> submethod <span class="ot">exists</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method parameters <span class="st">&quot;ensemble submethod&quot;</span> # Get parameters of submethod</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method definition <span class="st">&quot;ensemble submethod&quot;</span> # Get definition of submethod</span></code></pre></div>
<h4 id="method-types-and-return-types">Method Types and Return
Types</h4>
<p>NX supports several method types: - <code>scripted</code>: Regular
Tcl methods - <code>alias</code>: Aliases to Tcl commands -
<code>forward</code>: Forwarding to other methods - <code>object</code>:
Object-specific methods - <code>setter</code>: Property setter methods -
<code>builtin</code>: Built-in methods</p>
<p>Return types can be specified with <code>-returns</code> and
queried:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> method returns methodName      # Get <span class="kw">return</span> <span class="ot">type</span> constraint</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Common return types:</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># integer - Integer values</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># object - Object references</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># object,1..n - One or more object references</span></span></code></pre></div>
<h3 id="basic-object-creation-examples">Basic Object Creation
Examples</h3>
<p>The NX/NSF system provides several ways to create objects:</p>
<ol type="1">
<li><strong>Creating Basic Objects</strong></li>
</ol>
<div class="sourceCode" id="cb35"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple object</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> myObject</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object with initialization</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> myObject <span class="kw">{</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    :property age <span class="dv">0</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object in a specific namespace</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::app::myObject</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Creating Classes</strong></li>
</ol>
<div class="sourceCode" id="cb36"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a basic class</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Person <span class="kw">{</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    :property age <span class="dv">0</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Constructor logic</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    :method greet <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;Hello, my name is [:get name]&quot;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create instance of the class</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>Person <span class="ot">create</span> john<span class="ot"> -name</span> <span class="st">&quot;John Doe&quot;</span><span class="ot"> -age</span> <span class="dv">30</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Inheritance Examples</strong></li>
</ol>
<div class="sourceCode" id="cb37"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Single inheritance</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Employee<span class="ot"> -superclass</span> Person <span class="kw">{</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    :property department</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    :property salary</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        next ;<span class="co"># Call parent&#39;s init method</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple inheritance</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Manager<span class="ot"> -superclass</span> <span class="kw">{</span>Employee Leader<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    :property team</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h3 id="coroutines-and-yield">Coroutines and Yield</h3>
<p>The NX/NSF system provides powerful support for coroutines and
yielding, enabling advanced control flow patterns and asynchronous
programming capabilities.</p>
<h4 id="simple-number-generator">Simple Number Generator</h4>
<div class="sourceCode" id="cb38"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::numbers <span class="kw">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> :<span class="ot">delta</span> <span class="dv">2</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  :public object method ++ <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    yield</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> i <span class="dv">0</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="dv">1</span> <span class="kw">{</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      yield <span class="dt">$i</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">incr</span> i <span class="dt">${:delta}</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and use a coroutine</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>coroutine nextNumber ::numbers ++</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>nextNumber  # First call returns nothing, initializes coroutine</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>nextNumber  # Returns <span class="dv">0</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>nextNumber  # Returns <span class="dv">2</span>, etc.</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up coroutine</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="kw">rename</span> nextNumber <span class="kw">{}</span></span></code></pre></div>
<h4 id="enumerator-patterns">Enumerator Patterns</h4>
<h5 id="basic-enumerator-single-class">Basic Enumerator (Single
Class)</h5>
<div class="sourceCode" id="cb39"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Enumerator <span class="kw">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  :property members:<span class="dv">0</span>..n</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  :public method yielder <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    yield <span class="kw">[info</span> coroutine<span class="kw">]</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> m <span class="dt">${:members}</span> <span class="kw">{</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>      yield <span class="dt">$m</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span><span class="ot"> -level</span> <span class="dv">2</span><span class="ot"> -code</span> <span class="kw">break</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  :public method next <span class="kw">{}</span> <span class="kw">{</span><span class="dt">${:coro}</span><span class="kw">}</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    :<span class="ot">require</span> <span class="kw">namespace</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> :coro <span class="kw">[</span>coroutine <span class="kw">[</span>self<span class="kw">]</span>::coro <span class="kw">[</span>self<span class="kw">]</span> yielder<span class="kw">]</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> e <span class="kw">[</span>Enumerator new<span class="ot"> -members</span> <span class="kw">{</span><span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span><span class="kw">}]</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="dv">1</span> <span class="kw">{</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Will iterate through members and then break the loop</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">puts</span> <span class="kw">[</span><span class="dt">$e</span> next<span class="kw">]</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h5 id="advanced-enumerator-yielder-enumerator">Advanced Enumerator
(Yielder &amp; Enumerator)</h5>
<div class="sourceCode" id="cb40"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Yielder <span class="kw">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  :property <span class="kw">{</span>block <span class="st">&quot;;&quot;</span><span class="kw">}</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  :<span class="kw">variable</span> continuation <span class="st">&quot;&quot;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  :public alias apply ::apply</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  :public method yielder <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    yield <span class="kw">[info</span> coroutine<span class="kw">]</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">eval</span> <span class="dt">${:block}</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span><span class="ot"> -level</span> <span class="dv">2</span><span class="ot"> -code</span> <span class="kw">break</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  :public method next <span class="kw">{}</span> <span class="kw">{</span><span class="dt">${:continuation}</span><span class="kw">}</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  :public method each <span class="kw">{</span>var <span class="ot">body</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="dv">1</span> <span class="kw">{</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">uplevel</span> <span class="kw">[list</span> <span class="kw">set</span> <span class="dt">$var</span> <span class="kw">[</span>:next<span class="kw">]]</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>      <span class="kw">uplevel</span> <span class="dt">$body</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    :<span class="ot">require</span> <span class="kw">namespace</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> :continuation <span class="kw">[</span>coroutine <span class="kw">[</span>self<span class="kw">]</span>::coro <span class="kw">[</span>self<span class="kw">]</span> yielder<span class="kw">]</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Enumerator<span class="ot"> -superclass</span> Yielder <span class="kw">{</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  :property members:<span class="dv">0</span>..n</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  :property <span class="kw">{</span>block <span class="kw">{</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> m <span class="dt">${:members}</span> <span class="kw">{</span> yield <span class="dt">$m</span> <span class="kw">}</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}}</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h5 id="using-enumerator">Using Enumerator</h5>
<div class="sourceCode" id="cb41"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using next() method</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> e <span class="kw">[</span>Enumerator new<span class="ot"> -members</span> <span class="kw">{</span><span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span><span class="kw">}]</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="dv">1</span> <span class="kw">{</span> <span class="kw">incr</span> sum <span class="kw">[</span><span class="dt">$e</span> next<span class="kw">]</span> <span class="kw">}</span>  # Sum will be <span class="dv">6</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using each() method</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> e <span class="kw">[</span>Enumerator new<span class="ot"> -members</span> <span class="kw">{</span>a be bu<span class="kw">}]</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="dt">$e</span> each <span class="ot">x</span> <span class="kw">{</span> <span class="kw">append</span> <span class="kw">string</span> <span class="dt">$x</span> <span class="kw">}</span>  # String will contain <span class="st">&quot;abebu&quot;</span></span></code></pre></div>
<h5 id="extending-enumerator">Extending Enumerator</h5>
<div class="sourceCode" id="cb42"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ATeam<span class="ot"> -superclass</span> Enumerator <span class="kw">{</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  :public method each <span class="kw">{</span>var <span class="ot">body</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">while</span> <span class="dv">1</span> <span class="kw">{</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> value <span class="kw">[string</span> <span class="ot">totitle</span> <span class="kw">[</span>:next<span class="kw">]]</span>  # Capitalize <span class="ot">first</span> letter</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">uplevel</span> <span class="kw">[list</span> <span class="kw">set</span> <span class="dt">$var</span> <span class="dt">$value</span><span class="kw">]</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">uplevel</span> <span class="dt">$body</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  :public method <span class="kw">concat</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> <span class="kw">string</span> <span class="st">&quot;-&quot;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    :each <span class="ot">x</span> <span class="kw">{</span> <span class="kw">append</span> <span class="kw">string</span> <span class="dt">$x</span>- <span class="kw">}</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$string</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>ATeam <span class="ot">create</span> a1<span class="ot"> -members</span> <span class="kw">{</span>alice bob caesar<span class="kw">}</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>a1 <span class="kw">concat</span>  # Returns <span class="st">&quot;-Alice-Bob-Caesar-&quot;</span></span></code></pre></div>
<h4 id="apply-function">Apply Function</h4>
<p>The NX/NSF system provides powerful support for the apply function,
enabling functional programming patterns:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Register apply as an alias</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>::nx::Object public alias apply ::apply</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>::nx::Object <span class="ot">create</span> o <span class="kw">{</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> :<span class="ot">delta</span> <span class="dv">100</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  :public object method <span class="ot">map</span> <span class="kw">{</span>lambda <span class="ot">values</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> result <span class="kw">{}</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">foreach</span> value <span class="dt">$values</span> <span class="kw">{</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">lappend</span> result <span class="kw">[</span>:apply <span class="dt">$lambda</span> <span class="dt">$value</span><span class="kw">]</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$result</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>o <span class="ot">map</span> <span class="kw">{</span><span class="ot">x</span> <span class="kw">{return</span> <span class="kw">[string</span> <span class="ot">length</span> <span class="dt">$x</span><span class="kw">]</span>:<span class="dt">$x</span><span class="kw">}}</span> <span class="kw">{</span>a bb ccc<span class="kw">}</span>  # Returns <span class="st">&quot;1:a 2:bb 3:ccc&quot;</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>o <span class="ot">map</span> <span class="kw">{</span><span class="ot">x</span> <span class="kw">{expr</span> <span class="kw">{</span><span class="dt">$x</span> * <span class="dt">${:delta}</span><span class="kw">}}}</span> <span class="kw">{</span><span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span><span class="kw">}</span>  # Returns <span class="st">&quot;100 200 300&quot;</span></span></code></pre></div>
<h3 id="methods-and-properties">Methods and Properties</h3>
<p>The NX/NSF system provides comprehensive support for method
definition and property management:</p>
<h4 id="method-provision-and-requirements">Method Provision and
Requirements</h4>
<div class="sourceCode" id="cb44"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic method provision</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>nsf::method::<span class="ot">provide</span> method_name <span class="kw">{</span>implementation<span class="kw">}</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Alias to a Tcl command</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>nsf::method::<span class="ot">provide</span> <span class="kw">append</span> <span class="kw">{</span>::nsf::method::alias <span class="kw">append</span><span class="ot"> -frame</span> object ::<span class="kw">append}</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a custom method</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>nsf::method::<span class="ot">provide</span> foo <span class="kw">{</span>::nsf::method::<span class="ot">create</span> foo <span class="kw">{</span><span class="ot">x</span> <span class="ot">y</span><span class="kw">}</span> <span class="kw">{return</span> <span class="ot">x</span>=<span class="dt">$x</span>,<span class="ot">y</span>=<span class="dt">$y</span><span class="kw">}}</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide a method using a mixin</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>nsf::method::<span class="ot">provide</span> <span class="ot">x</span> <span class="kw">{</span>::get_mixin ::MIX <span class="ot">x</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  ::nx::Class <span class="ot">create</span> ::MIX <span class="kw">{</span>:public method <span class="ot">x</span> <span class="kw">{}</span> <span class="kw">{return</span> <span class="ot">x</span><span class="kw">}}</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="method-requirements">Method Requirements</h4>
<p>Methods can be required in class definitions to ensure proper
interface implementation:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Require a method in a class definition</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> C <span class="kw">{</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">require</span> method <span class="kw">set</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">require</span> method <span class="ot">exists</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Require a method with different name than registered name</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> method tcl::<span class="kw">set</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Require object methods</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> object method <span class="kw">lappend</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Public vs. Protected methods</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> public method <span class="kw">lappend</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> protected method <span class="kw">lappend</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Require methods directly on objects</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>Object <span class="ot">create</span> o1</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>o1 <span class="ot">require</span> object method <span class="kw">set</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>o1 <span class="ot">require</span> public object method <span class="kw">lappend</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>o1 <span class="ot">require</span> protected object method <span class="kw">lappend</span></span></code></pre></div>
<h4 id="method-properties-and-protection">Method Properties and
Protection</h4>
<p>Methods can have various properties and protection levels:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a method is protected</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::property C <span class="kw">lappend</span> call-protected</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Protected methods cannot be redefined as public</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>nx::Class public method __alloc arg <span class="kw">{return</span> <span class="dv">1</span><span class="kw">}</span>  # Will fail</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Class-specific methods cannot be called on objects</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>::nsf::method::<span class="ot">require</span> object __alloc  # Will fail when called</span></code></pre></div>
<h4 id="parentnamespace-requirements">Parent/Namespace Requirements</h4>
<p>The NX framework creates parent namespaces automatically when
needed:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating objects in nested namespaces</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">create</span> ::o::o        # Creates ::o <span class="kw">namespace</span> and ::o::o object</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">create</span> ::<span class="dv">1</span>::<span class="dv">2</span>::<span class="dv">3</span>::<span class="dv">4</span>  # Creates all <span class="ot">parent</span> namespaces and the object</span></code></pre></div>
<h4 id="method-definition-and-usage">Method Definition and Usage</h4>
<div class="sourceCode" id="cb48"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Example <span class="kw">{</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public method</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    :public method sayHello <span class="kw">{</span><span class="ot">name</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;Hello, </span><span class="dt">$</span><span class="st">name!&quot;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Protected method - only accessible by class and subclasses</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    :protected method internalHelper <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Internal implementation</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Method with default arguments</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    :public method greet <span class="kw">{{</span>greeting <span class="st">&quot;Hello&quot;</span><span class="kw">}</span> <span class="ot">name</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;</span><span class="dt">$</span><span class="st">greeting, </span><span class="dt">$</span><span class="st">name!&quot;</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Using methods</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> obj <span class="kw">[</span>Example new<span class="kw">]</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> sayHello <span class="st">&quot;World&quot;</span></span></code></pre></div>
<h4 id="properties">Properties</h4>
<p>Properties in NX/NSF can be defined with various characteristics:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Person <span class="kw">{</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simple property</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Property with default value</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">{</span>age <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Property with type checking</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    :property<span class="ot"> -incremental</span> <span class="kw">{</span>friends:object,*<span class="kw">}</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Property with custom accessor</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">{</span>score <span class="dv">0</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        :public object method score=<span class="kw">set</span> <span class="kw">{</span>obj prop value<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="kw">{</span><span class="dt">$value</span> &lt; <span class="dv">0</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                <span class="kw">error</span> <span class="st">&quot;Score cannot be negative&quot;</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>            next <span class="dt">$obj</span> <span class="dt">$prop</span> <span class="dt">$value</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="property-declaration-syntax">Property Declaration Syntax</h4>
<p>Properties can be declared at both class and object levels with
various options:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Class Level Properties</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>                    # Basic property</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> public|protected|private|none <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>  # With accessor</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -incremental</span> <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>       # For collections</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -incremental</span> <span class="ot">name</span>:<span class="ot">type</span>,multiplicity   # With <span class="ot">type</span> and multiplicity</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> none<span class="ot"> -configurable</span> false <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>  # Non-configurable</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Object Level Properties</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>:object property <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>             # Basic object property</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> public|protected|private|none <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>  # With accessor</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -incremental</span> <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span>  # For collections</span></code></pre></div>
<h4 id="accessor-visibility">Accessor Visibility</h4>
<p>Properties can have different access levels: -
<strong>public</strong>: Accessible from anywhere -
<strong>protected</strong>: Accessible only from methods in the class
and its subclasses - <strong>private</strong>: Accessible only from
methods within the class - <strong>none</strong>: No accessor method is
created</p>
<h4 id="incremental-properties">Incremental Properties</h4>
<p>The <code>-incremental</code> flag changes property behavior: -
Creates an accessor even when not explicitly requested - Enables
collection operations (add, delete) - Makes properties multivalued by
default</p>
<h4 id="property-operations">Property Operations</h4>
<div class="sourceCode" id="cb51"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure a property</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>object <span class="ot">configure -propertyName</span> value</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get property value</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>object <span class="ot">cget -propertyName</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using accessor methods</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="ot">get</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="kw">set</span> newValue</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Incremental property operations</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="ot">add</span> value</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="kw">set</span> <span class="kw">{</span>value1 value2 value3<span class="kw">}</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="ot">delete</span> value</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="ot">delete -nocomplain</span> value</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="ot">exists</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>object propertyName <span class="kw">unset</span></span></code></pre></div>
<h4 id="property-multiplicity">Property Multiplicity</h4>
<p>Properties can have different multiplicity constraints: -
<strong>0..n</strong>: Zero or more values (default for incremental
properties) - <strong>1..n</strong>: One or more values (non-empty) -
<strong>0..1</strong>: Zero or one value (optional) -
<strong>1..1</strong>: Exactly one value (required)</p>
<h4 id="variable-substitution-with-substdefault">Variable Substitution
with substdefault</h4>
<p>The <code>substdefault</code> modifier in NX/TCL framework allows for
variable substitution in default values. This feature provides
fine-grained control over how variables, commands, and backslashes are
substituted in property default values.</p>
<h5 id="basic-syntax">Basic Syntax</h5>
<div class="sourceCode" id="cb52"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span><span class="ot">name</span>:substdefault <span class="st">&quot;value&quot;</span><span class="kw">}</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span><span class="ot">name</span>:substdefault=OPTION <span class="st">&quot;value&quot;</span><span class="kw">}</span></span></code></pre></div>
<p>Where OPTION is a binary flag that controls the substitution
behavior.</p>
<h5 id="substitution-options">Substitution Options</h5>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 24%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th>Flag Notation</th>
<th>Decimal</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0b111</td>
<td>7</td>
<td>Substitute all (variables, commands, backslashes)</td>
</tr>
<tr class="even">
<td>0b100</td>
<td>4</td>
<td>Only substitute backslashes (-novars -nocommands)</td>
</tr>
<tr class="odd">
<td>0b010</td>
<td>2</td>
<td>Only substitute variables (-nocommands -nobackslashes)</td>
</tr>
<tr class="even">
<td>0b001</td>
<td>1</td>
<td>Only substitute commands (-novars -nobackslashes)</td>
</tr>
<tr class="odd">
<td>0b000</td>
<td>0</td>
<td>Substitute nothing (-nocommands -novars -nobackslashes)</td>
</tr>
</tbody>
</table>
<h5 id="examples-with-results">Examples with Results</h5>
<p>Given input: <code>{a $::X [set x 4] \t}</code></p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 41%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Result</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No substdefault</td>
<td><code>a $::X [set x 4] \t</code></td>
<td>No substitution</td>
</tr>
<tr class="even">
<td>:substdefault</td>
<td><code>a 123 4</code></td>
<td>Default substitution (all)</td>
</tr>
<tr class="odd">
<td>:substdefault=0b111</td>
<td><code>a 123 4</code></td>
<td>Substitute all</td>
</tr>
<tr class="even">
<td>:substdefault=0b100</td>
<td><code>a $::X [set x 4]</code></td>
<td>Only substitute backslashes</td>
</tr>
<tr class="odd">
<td>:substdefault=0b010</td>
<td><code>a 123 [set x 4] \t</code></td>
<td>Only substitute variables</td>
</tr>
<tr class="even">
<td>:substdefault=0b001</td>
<td><code>a $::X 4 \t</code></td>
<td>Only substitute commands</td>
</tr>
<tr class="odd">
<td>:substdefault=0b000</td>
<td><code>a $::X [set x 4] \t</code></td>
<td>No substitution</td>
</tr>
</tbody>
</table>
<h5 id="context-and-scoping">Context and Scoping</h5>
<ol type="1">
<li><strong>General Considerations</strong>
<ul>
<li><code>[self]</code> is always set correctly in substdefault
expressions</li>
</ul></li>
<li><strong>Object Parameters</strong>
<ul>
<li>Use caution when referring to instance variables</li>
<li>Referring to global or namespaced variables avoids creation order
issues</li>
<li><code>[current class]</code> called directly may not return expected
results</li>
<li>Recommendation: Define methods to get default values instead of
direct references</li>
</ul></li>
<li><strong>Method Parameters</strong>
<ul>
<li>Instance variables can be referenced directly in the default
scope</li>
<li>Method frame contains instance variables, allowing direct
access</li>
</ul></li>
</ol>
<h5 id="usage-patterns">Usage Patterns</h5>
<ol type="1">
<li><strong>Referring to Current Object</strong></li>
</ol>
<div class="sourceCode" id="cb53"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>b:substdefault <span class="st">&quot;[current]&quot;</span><span class="kw">}</span>  # Evaluates to object <span class="ot">name</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Accessing Property Values</strong></li>
</ol>
<div class="sourceCode" id="cb54"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> public <span class="kw">{</span>c <span class="dv">1</span><span class="kw">}</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>param:substdefault <span class="st">&quot;[:c get]&quot;</span><span class="kw">}</span>  # Access another property&#39;s value</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Accessing Instance Variables</strong></li>
</ol>
<div class="sourceCode" id="cb55"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>d <span class="dv">2</span><span class="kw">}</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>param:substdefault <span class="st">&quot;</span><span class="dt">$</span><span class="st">d&quot;</span><span class="kw">}</span>  # Direct reference to instance <span class="kw">variable</span></span></code></pre></div>
<ol start="4" type="1">
<li><strong>Accessing Object Variables</strong></li>
</ol>
<div class="sourceCode" id="cb56"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>:object <span class="kw">variable</span> Y <span class="dv">1002</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>param:substdefault <span class="st">&quot;[:object getvar Y]&quot;</span><span class="kw">}</span>  # Access object <span class="kw">variable</span></span></code></pre></div>
<ol start="5" type="1">
<li><strong>Accessing Class Information</strong></li>
</ol>
<div class="sourceCode" id="cb57"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>param:substdefault <span class="st">&quot;[:current class]&quot;</span><span class="kw">}</span>  # Get <span class="ot">current</span> <span class="ot">class</span></span></code></pre></div>
<ol start="6" type="1">
<li><strong>Accessing Namespaced Variables</strong></li>
</ol>
<div class="sourceCode" id="cb58"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="kw">eval</span> ::my-module <span class="kw">{</span> <span class="kw">set</span> X <span class="dv">1001</span> <span class="kw">}</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>:method <span class="kw">file</span>-scoped <span class="kw">{</span><span class="ot">x</span><span class="kw">}</span> <span class="kw">{</span> <span class="kw">namespace</span> <span class="kw">eval</span> ::my-module <span class="kw">[list</span> <span class="kw">set</span> <span class="dt">$x</span> <span class="kw">]</span> <span class="kw">}</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>:property <span class="kw">{</span>param:substdefault <span class="st">&quot;[:file-scoped X]&quot;</span><span class="kw">}</span>  # Access namespaced <span class="kw">variable</span></span></code></pre></div>
<h5 id="special-cases-and-caveats">Special Cases and Caveats</h5>
<ol type="1">
<li>The value of <code>[current class]</code> directly in substdefault
may not be as expected
<ul>
<li>Use a method that returns <code>[current class]</code> instead</li>
</ul></li>
<li>When using substdefault in a namespace:
<ul>
<li>The scope of <code>[current]</code> is preserved (e.g.,
<code>::my-module::d1</code>)</li>
<li>Definition namespace can be accessed via
<code>[nsf::definitionnamespace]</code></li>
</ul></li>
<li>Dynamic resolution:
<ul>
<li>Variable values are resolved dynamically at the time of
evaluation</li>
<li>Changes to instance variables are reflected in subsequent
evaluations</li>
</ul></li>
</ol>
<h5 id="best-practices-1">Best Practices</h5>
<ol type="1">
<li>Use methods to get default values instead of direct expressions</li>
<li>Leverage namespaces for better organization of variables</li>
<li>Be aware of the evaluation context when using substdefault</li>
<li>Use appropriate substitution flags based on security and performance
needs</li>
<li>For complex cases, define helper methods that return the appropriate
values</li>
</ol>
<h4 id="private-storage">Private Storage</h4>
<p>Private properties are stored in the <code>__private</code>
array:</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the private storage (from within a method)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">array</span> <span class="ot">get</span> :__private</span></code></pre></div>
<h4 id="property-inheritance">Property Inheritance</h4>
<p>Properties follow inheritance rules: - Properties defined in a
superclass are inherited by subclasses - Properties from mixins are also
available - Adding a property to a superclass or mixin makes it
available to all dependent classes</p>
<h4 id="property-introspection">Property Introspection</h4>
<div class="sourceCode" id="cb60"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List available configure options</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>object <span class="kw">info</span> lookup syntax <span class="ot">configure</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a property method exists</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>object <span class="kw">info</span> lookup method propertyName</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all slots in a class</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>Class <span class="kw">info</span> slots</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get slot definition</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>::Class::slot::propertyName definition</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check property protection level</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>nsf::method::property Class propertyName call-protected</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>nsf::method::property Class propertyName call-private</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Check instance variables</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>object <span class="kw">info</span> <span class="ot">vars</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Get object slot</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>object <span class="kw">info</span> object slots propertyName</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Get multiplicity of a property</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span>object <span class="kw">info</span> object slots propertyName<span class="kw">]</span> <span class="kw">eval</span> <span class="kw">{set</span> :multiplicity<span class="kw">}</span></span></code></pre></div>
<h4 id="common-property-patterns">Common Property Patterns</h4>
<ol type="1">
<li>Use <code>-accessor none</code> when you just need storage without
accessors</li>
<li>Use <code>-incremental</code> for collection properties</li>
<li>Use public accessors for properties that need external access</li>
<li>Use protected and private for implementation details</li>
<li>Use proper type and multiplicity constraints to validate property
values</li>
<li>Check property existence before access with <code>exists</code></li>
<li>Default accessors can be configured globally with
<code>nx::configure defaultAccessor</code></li>
</ol>
<h3 id="protection-mechanisms">Protection Mechanisms</h3>
<p>The NX/NSF system provides comprehensive protection mechanisms for
methods and properties, allowing fine-grained control over access and
visibility.</p>
<h4 id="access-modifiers">Access Modifiers</h4>
<p>Methods and properties can be declared with different access
levels:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method Declaration with Access Modifiers</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>:public method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span>      # Public method (<span class="ot">default</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>:protected method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span>   # Protected method</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>:private method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span>     # Private method</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Per-object methods</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>:public object method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>:protected object method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>:private object method methodName <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span><span class="ot">body</span><span class="kw">}</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Property Declaration with Access Modifiers</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> public <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span>     # Public property</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> protected <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span>  # Protected property</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> private <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span>    # Private property</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Property with value constraint</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>:property<span class="ot"> -accessor</span> private <span class="kw">{</span>propertyName:<span class="ot">type</span> defaultValue<span class="kw">}</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Per-object properties</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> public <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> protected <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>:object property<span class="ot"> -accessor</span> private <span class="kw">{</span>propertyName defaultValue<span class="kw">}</span></span></code></pre></div>
<h4 id="method-property-handling">Method Property Handling</h4>
<p>Methods can have various protection flags that can be checked and
modified:</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a method is protected</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName call-protected</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns 1 if protected, 0 if not</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a method as protected</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName call-protected true</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a method is private</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName call-private</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns 1 if private, 0 if not</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a method as private</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName call-private true</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Prevent a method from being redefined</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName redefine-protected true</span></code></pre></div>
<h4 id="calling-protected-and-private-methods">Calling Protected and
Private Methods</h4>
<p>There are several ways to access protected and private methods:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Local Method Access (Within the same class)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>:<span class="ot"> -local</span> privateMethodName arg1 arg2</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Method Handles</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">handle</span> <span class="kw">[</span>ClassName <span class="kw">info</span> method registrationhandle methodName<span class="kw">]</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>: <span class="dt">$handle</span> arg1 arg2</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Dispatch</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>dispatch <span class="kw">[</span>self<span class="kw">]</span> <span class="kw">[</span>ClassName <span class="kw">info</span> method registrationhandle methodName<span class="kw">]</span> arg1 arg2</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calling protected methods with nx::dispatch</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>nx::dispatch objectName methodName <span class="ot">args</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Bypass an overloaded system method</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>nx::dispatch objectName<span class="ot"> -system</span> methodName <span class="ot">args</span></span></code></pre></div>
<h4 id="protection-behavior-with-inheritance">Protection Behavior with
Inheritance</h4>
<ol type="1">
<li>Public methods in a subclass can access all public methods from
superclasses</li>
<li>Private methods in a subclass can only be called via
<code>-local</code> or method handles</li>
<li>Private methods do not participate in the <code>next</code> chain -
they’re skipped</li>
<li>Protected methods are not callable from outside but are callable
from subclasses</li>
<li>Private properties in different classes don’t conflict, even with
the same name</li>
</ol>
<h4 id="protection-with-mixins-and-filters">Protection with Mixins and
Filters</h4>
<ol type="1">
<li>Private methods in mixins are invisible to method calls but can be
called by other methods in the same mixin</li>
<li>Protected and private methods can be used as filters</li>
<li>Mixin methods can call protected/private methods from the class
they’re mixed into</li>
<li>Filters run on all methods, including when accessing private methods
via <code>-local</code></li>
</ol>
<h4 id="common-protection-patterns">Common Protection Patterns</h4>
<ol type="1">
<li><strong>Private Helper Methods in Mixins</strong></li>
</ol>
<div class="sourceCode" id="cb64"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MyMixin <span class="kw">{</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  :public method publicAPI <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> privateHelper<span class="kw">}</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  :private method privateHelper <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Implementation details hidden from users</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="st">&quot;result&quot;</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Protected Class Hierarchy Methods</strong></li>
</ol>
<div class="sourceCode" id="cb65"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Base <span class="kw">{</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  :protected method implementation <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shared with subclasses but not with external callers</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="st">&quot;base implementation&quot;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  :public method publicAPI <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> implementation<span class="kw">}</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Sub<span class="ot"> -superclass</span> Base <span class="kw">{</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  :protected method implementation <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="st">&quot;Sub [next]&quot;</span>  # Can call protected method in superclass</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Private Object State</strong></li>
</ol>
<div class="sourceCode" id="cb66"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj <span class="kw">{</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  :object property<span class="ot"> -accessor</span> private <span class="kw">{</span><span class="ot">state</span> initial<span class="kw">}</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  :public object method getState <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> <span class="ot">state</span> <span class="ot">get</span><span class="kw">}</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  :public object method setState <span class="kw">{</span>newValue<span class="kw">}</span> <span class="kw">{</span>:<span class="ot"> -local</span> <span class="ot">state</span> <span class="kw">set</span> <span class="dt">$newValue</span><span class="kw">}</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="4" type="1">
<li><strong>System Method Override with Dispatch</strong></li>
</ol>
<div class="sourceCode" id="cb67"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj <span class="kw">{</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  :public object method <span class="kw">info</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Custom info implementation</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="st">&quot;Custom info&quot;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  :public object method realInfo <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Access the actual system info method</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="kw">[</span>nx::dispatch <span class="kw">[</span>self<span class="kw">]</span><span class="ot"> -system</span> <span class="kw">info]</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h3 id="method-protection-and-visibility">Method Protection and
Visibility</h3>
<p>The NX/NSF system provides three levels of method protection to
control access and visibility:</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> SecureClass <span class="kw">{</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public interface - accessible from anywhere</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    :public method publicMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;This is public&quot;</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Protected method - only accessible by class and subclasses</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    :protected method protectedMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;This is protected&quot;</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private method - only accessible within the class</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    :private method privateMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;This is private&quot;</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="protection-levels">Protection Levels</h4>
<ol type="1">
<li><strong>Public Methods</strong>
<ul>
<li>Accessible from anywhere</li>
<li>Default interface for the class/object</li>
<li>Can be called by any other object</li>
<li>Example:</li>
</ul>
<div class="sourceCode" id="cb69"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>:public method getData <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">${:data}</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><strong>Protected Methods</strong>
<ul>
<li>Only accessible within the class hierarchy</li>
<li>Can be called by the class and its subclasses</li>
<li>Useful for internal class operations</li>
<li>Example:</li>
</ul>
<div class="sourceCode" id="cb70"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>:protected method validateData <span class="kw">{</span>data<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="kw">{</span>!<span class="kw">[</span>::nsf::<span class="ot">is</span> valid <span class="dt">$data</span><span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> <span class="st">&quot;Invalid data format&quot;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$data</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><strong>Private Methods</strong>
<ul>
<li>Only accessible within the defining class/object</li>
<li>Highest level of encapsulation</li>
<li>Cannot be called from outside the class</li>
<li>Example:</li>
</ul>
<div class="sourceCode" id="cb71"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>:private method internalHelper <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Internal implementation details</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="best-practices-for-method-protection">Best Practices for Method
Protection</h4>
<ol type="1">
<li><p><strong>Interface Design</strong></p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> BankAccount <span class="kw">{</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public interface</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    :public method deposit <span class="kw">{</span>amount<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>        :validateAmount <span class="dt">$amount</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>        :updateBalance <span class="dt">$amount</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Protected validation</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    :protected method validateAmount <span class="kw">{</span>amount<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{</span><span class="dt">$amount</span> &lt;= <span class="dv">0</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>            <span class="kw">error</span> <span class="st">&quot;Amount must be positive&quot;</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private implementation</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    :private method updateBalance <span class="kw">{</span>amount<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">incr</span> :balance <span class="dt">$amount</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Inheritance Considerations</strong></p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> BaseClass <span class="kw">{</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    :protected method sharedLogic <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shared implementation for subclasses</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> SubClass<span class="ot"> -superclass</span> BaseClass <span class="kw">{</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    :public method publicMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>        :sharedLogic  # Can access protected method</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Encapsulation</strong></p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DataStore <span class="kw">{</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> internalData</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public accessor</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    :public method getData <span class="kw">{</span>key<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        :validateKey <span class="dt">$key</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[</span>:retrieveData <span class="dt">$key</span><span class="kw">]</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private implementation</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    :private method retrieveData <span class="kw">{</span>key<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">${:internalData($key)}</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="return-value-checking">Return Value Checking</h4>
<p>NX provides a comprehensive system for checking and validating method
return values. This system allows for type checking and conversion of
method return values.</p>
<h5 id="basic-configuration">Basic Configuration</h5>
<div class="sourceCode" id="cb75"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable return value checking globally</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>::nsf::<span class="ot">configure</span> checkresult true</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable return value checking globally</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>::nsf::<span class="ot">configure</span> checkresults false</span></code></pre></div>
<h5 id="setting-return-types">Setting Return Types</h5>
<p>Return types can be set in two ways:</p>
<ol type="1">
<li><strong>For Existing Methods</strong></li>
</ol>
<div class="sourceCode" id="cb76"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set return type for a method</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns typeName</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set return type with additional arguments</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns typeName,arg=value</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable value conversion for return values</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns typeName,convert</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove return type checking</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns <span class="st">&quot;&quot;</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>During Method Declaration</strong></li>
</ol>
<div class="sourceCode" id="cb77"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method with return type</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>:method methodName <span class="kw">{</span>param1 param2<span class="kw">}</span><span class="ot"> -returns</span> typeName <span class="kw">{</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># method body</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Alias with return type</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>:alias aliasName<span class="ot"> -returns</span> typeName<span class="ot"> -frame</span> object ::someCommand</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward with return type</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>:forward forwardName<span class="ot"> -returns</span> typeName ::someCommand</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Object method with complex return type (object with cardinality)</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>:public object method methodName <span class="kw">{}</span><span class="ot"> -returns</span> object,<span class="dv">1</span>..n <span class="kw">{</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># method body</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h5 id="built-in-return-types">Built-in Return Types</h5>
<ul>
<li><code>integer</code>: Checks if return value is an integer</li>
<li><code>object</code>: Checks if return value is a valid object</li>
<li><code>object,1..n</code>: Checks if return value is one or more
valid objects</li>
</ul>
<h5 id="custom-return-types">Custom Return Types</h5>
<p>Custom return types can be created using the
<code>::nx::methodParameterSlot</code> command:</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>::nx::methodParameterSlot object method <span class="ot">type</span>=typeName <span class="kw">{</span><span class="ot">name</span> value <span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validation logic</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="kw">{</span>!valid<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> <span class="st">&quot;Error message&quot;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$value</span>  # Return original or modified value</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p>Example: Range Type</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>::nx::methodParameterSlot object method <span class="ot">type</span>=<span class="ot">range</span> <span class="kw">{</span><span class="ot">name</span> value arg<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lassign</span> <span class="kw">[split</span> <span class="dt">$arg</span> -<span class="kw">]</span> min max</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="kw">{</span><span class="dt">$value</span> &lt; <span class="dt">$min</span> || <span class="dt">$value</span> &gt; <span class="dt">$max</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> <span class="st">&quot;Value &#39;</span><span class="dt">$</span><span class="st">value&#39; of parameter </span><span class="dt">$</span><span class="st">name not between </span><span class="dt">$</span><span class="st">min and </span><span class="dt">$</span><span class="st">max&quot;</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$value</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns <span class="ot">range</span>,arg=<span class="dv">1-30</span></span></code></pre></div>
<p>Example: Value Conversion Type</p>
<div class="sourceCode" id="cb80"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>::nx::methodParameterSlot object method <span class="ot">type</span>=sex <span class="kw">{</span><span class="ot">name</span> value <span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">switch</span><span class="ot"> -glob</span> <span class="dt">$value</span> <span class="kw">{</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>        m* <span class="kw">{return</span> m<span class="kw">}</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>        f* <span class="kw">{return</span> f<span class="kw">}</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>        <span class="ot">default</span> <span class="kw">{error</span> <span class="st">&quot;expected sex but got </span><span class="dt">$</span><span class="st">value&quot;</span><span class="kw">}</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage with conversion:</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>::nsf::method::property ClassName methodName returns sex,convert</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now &quot;male&quot; returns as &quot;m&quot;, &quot;female&quot; as &quot;f&quot;</span></span></code></pre></div>
<h5 id="behavior-with-check-results-enableddisabled">Behavior with Check
Results Enabled/Disabled</h5>
<ol type="1">
<li><strong>With <code>checkresult true</code></strong>:
<ul>
<li>Methods with return type constraints will validate return
values</li>
<li>Return value errors are raised when constraints aren’t met</li>
<li>Converters with <code>convert</code> flag still function</li>
</ul></li>
<li><strong>With <code>checkresult false</code></strong>:
<ul>
<li>Type checking is disabled (no errors for invalid return values)</li>
<li>Converters with <code>convert</code> flag still function (conversion
still happens)</li>
</ul></li>
</ol>
<h5 id="method-types-supporting-return-values">Method Types Supporting
Return Values</h5>
<ul>
<li>Regular methods (<code>:method</code>)</li>
<li>Object methods (<code>:object method</code>)</li>
<li>Aliases (<code>:alias</code>)</li>
<li>Forwards (<code>:forward</code>)</li>
</ul>
<h5 id="common-error-messages">Common Error Messages</h5>
<ul>
<li><code>expected integer but got "x" as return value</code></li>
<li><code>Value 'x' of parameter return-value not between min and max</code></li>
<li><code>expected sex but got x</code></li>
</ul>
<h5 id="testing-return-values">Testing Return Values</h5>
<div class="sourceCode" id="cb81"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In NX test cases:</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>objectName methodName <span class="ot">args</span><span class="kw">}</span> expectedResult</span></code></pre></div>
<h5 id="notes-on-empty-parameter-definitions">Notes on Empty Parameter
Definitions</h5>
<ul>
<li>Return value specifications work even with methods that have no
parameters</li>
<li>Setting a return type does not affect the parameter definitions</li>
</ul>
<h4 id="method-combination-with-next">Method Combination with
<code>next</code></h4>
<p>The <code>next</code> command is used to call the next method in the
method chain. It is a powerful feature in NX that allows for method
chaining and delegation.</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of method chaining</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj <span class="kw">{</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    :public method foo <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;foo&quot;</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    :public method bar <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;bar&quot;</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> foo</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> bar</span></code></pre></div>
<h3 id="method-forwarding">Method Forwarding</h3>
<p>The NX/NSF system provides powerful method forwarding capabilities
that allow methods to be delegated to other objects or commands:</p>
<h4 id="basic-forward-command-syntax">Basic Forward Command Syntax</h4>
<div class="sourceCode" id="cb83"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>object public <span class="kw">[</span>object<span class="kw">]</span> forward methodName targetObject|targetCommand <span class="kw">[</span><span class="ot">args</span>...<span class="kw">]</span></span></code></pre></div>
<h4 id="basic-usage-patterns">Basic Usage Patterns</h4>
<ol type="1">
<li><strong>Simple Delegation</strong></li>
</ol>
<div class="sourceCode" id="cb84"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delegate method calls to another object</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> dog</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> <span class="ot">tail</span> <span class="kw">{</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  :public object method wag <span class="ot">args</span> <span class="kw">{</span> <span class="kw">return</span> <span class="dt">$args</span> <span class="kw">}</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>dog public object forward wag <span class="ot">tail</span> %<span class="kw">proc</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Executing Commands</strong></li>
</ol>
<div class="sourceCode" id="cb85"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward to Tcl commands</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj <span class="kw">{</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  :public object forward addOne <span class="kw">expr</span> <span class="dv">1</span> +</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># obj addOne 5  -&gt; returns 6</span></span></code></pre></div>
<h4 id="special-substitution-variables">Special Substitution
Variables</h4>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%self</code></td>
<td>Reference to the current object</td>
</tr>
<tr class="even">
<td><code>%method</code></td>
<td>Name of the current method</td>
</tr>
<tr class="odd">
<td><code>%proc</code></td>
<td>Refers to the target procedure</td>
</tr>
<tr class="even">
<td><code>%%</code></td>
<td>Literal percent sign</td>
</tr>
<tr class="odd">
<td><code>%1</code></td>
<td>First argument or default from list</td>
</tr>
</tbody>
</table>
<h4 id="forwarding-options">Forwarding Options</h4>
<table>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-frame object</code></td>
<td>Execute in object’s variable scope</td>
</tr>
<tr class="even">
<td><code>-prefix string</code></td>
<td>Add prefix to method name</td>
</tr>
<tr class="odd">
<td><code>-verbose</code></td>
<td>Enable verbose mode</td>
</tr>
</tbody>
</table>
<h4 id="positional-substitutions">Positional Substitutions</h4>
<div class="sourceCode" id="cb86"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add argument at the end</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>obj public object forward foo <span class="kw">list</span> <span class="kw">{</span>%@end value<span class="kw">}</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># obj foo 1 2 3  -&gt; returns [1 2 3 value]</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add argument at specific position</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>obj public object forward foo <span class="kw">list</span> <span class="kw">{</span>%@<span class="dv">2</span> value<span class="kw">}</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obj foo 1 2 3  -&gt; returns [1 value 2 3]</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add argument at beginning</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>obj public object forward foo <span class="kw">list</span> <span class="kw">{</span>%@<span class="dv">1</span> value<span class="kw">}</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co"># obj foo 1 2 3  -&gt; returns [value 1 2 3]</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add argument at second-to-last position</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>obj public object forward foo <span class="kw">list</span> <span class="kw">{</span>%@-<span class="dv">1</span> value<span class="kw">}</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># obj foo 1 2 3  -&gt; returns [1 2 value 3]</span></span></code></pre></div>
<h4 id="dynamic-command-selection">Dynamic Command Selection</h4>
<div class="sourceCode" id="cb87"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose from multiple methods based on first argument</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>obj public object forward foo %self <span class="kw">{</span>%<span class="dv">1</span> <span class="kw">{</span>methodA methodB<span class="kw">}}</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># With default values</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>obj public object forward foo %self <span class="kw">{</span>%<span class="dv">1</span> <span class="kw">{</span>methodA methodB<span class="kw">}}</span> <span class="kw">{</span>%<span class="dv">1</span> <span class="kw">{</span>defaultA defaultB<span class="kw">}}</span></span></code></pre></div>
<h4 id="argument-count-based-forwarding">Argument Count-Based
Forwarding</h4>
<div class="sourceCode" id="cb88"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> obj <span class="kw">{</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  :public object forward f %self <span class="kw">[list</span> %argclindex <span class="kw">[list</span> a b c<span class="kw">]]</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  :object method a <span class="ot">args</span> <span class="kw">{</span>...<span class="kw">}</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  :object method b <span class="ot">args</span> <span class="kw">{</span>...<span class="kw">}</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  :object method c <span class="ot">args</span> <span class="kw">{</span>...<span class="kw">}</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># obj f       -&gt; calls method a</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># obj f 1     -&gt; calls method b with argument 1</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># obj f 1 2   -&gt; calls method c with arguments 1 2</span></span></code></pre></div>
<h4 id="introspection">Introspection</h4>
<div class="sourceCode" id="cb89"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all forwarders</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object methods<span class="ot"> -type</span> forwarder</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get forwarder definition</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">info</span> object method definition forwardName</span></code></pre></div>
<h4 id="variable-scope-access">Variable Scope Access</h4>
<div class="sourceCode" id="cb90"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> X <span class="kw">{</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  :property <span class="kw">{</span><span class="ot">x</span> <span class="dv">1</span><span class="kw">}</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  :public forward Incr<span class="ot"> -frame</span> object <span class="kw">incr</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Allows accessing object variables</span></span></code></pre></div>
<h4 id="fully-qualified-target-shortcut">Fully-Qualified Target
Shortcut</h4>
<div class="sourceCode" id="cb91"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shortcut for forwarding to a fully-qualified command</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>obj public object forward ::ns1::foo</span></code></pre></div>
<h4 id="using-object-variables-in-forwarded-commands">Using Object
Variables in Forwarded Commands</h4>
<div class="sourceCode" id="cb92"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access object variable</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>obj public object forward <span class="ot">x</span>* <span class="kw">expr</span> <span class="kw">{</span>%:<span class="kw">eval</span> <span class="kw">{set</span> :<span class="ot">x</span><span class="kw">}}</span> *</span></code></pre></div>
<h3 id="ensemble-objects">Ensemble Objects</h3>
<p>Ensemble objects provide a way to organize related methods into
logical groups, creating a hierarchical command structure:</p>
<div class="sourceCode" id="cb93"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an ensemble object for grouped functionality</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Calculator <span class="kw">{</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    :public object method math.<span class="ot">add</span> <span class="kw">{</span>a b<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[expr</span> <span class="kw">{</span><span class="dt">$a</span> + <span class="dt">$b</span><span class="kw">}]</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    :public object method math.subtract <span class="kw">{</span>a b<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[expr</span> <span class="kw">{</span><span class="dt">$a</span> - <span class="dt">$b</span><span class="kw">}]</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    :public object method math.multiply <span class="kw">{</span>a b<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[expr</span> <span class="kw">{</span><span class="dt">$a</span> * <span class="dt">$b</span><span class="kw">}]</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>Calculator math <span class="ot">add</span> <span class="dv">5</span> <span class="dv">3</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>Calculator math subtract <span class="dv">10</span> <span class="dv">4</span></span></code></pre></div>
<h4 id="ensemble-features">Ensemble Features</h4>
<ol type="1">
<li><p><strong>Logical Grouping</strong></p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> FileManager <span class="kw">{</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># File operations</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    :public object method <span class="kw">file</span>.<span class="kw">open</span> <span class="kw">{</span>filename<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[open</span> <span class="dt">$filename</span> r<span class="kw">]</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    :public object method <span class="kw">file</span>.<span class="kw">close</span> <span class="kw">{</span><span class="ot">handle</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">close</span> <span class="dt">$handle</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Directory operations</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    :public object method dir.<span class="ot">create</span> <span class="kw">{</span>path<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">file</span> <span class="ot">mkdir</span> <span class="dt">$path</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    :public object method dir.<span class="ot">delete</span> <span class="kw">{</span>path<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">file</span> <span class="ot">delete</span> <span class="dt">$path</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>FileManager <span class="kw">file</span> <span class="kw">open</span> <span class="st">&quot;example.txt&quot;</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>FileManager dir <span class="ot">create</span> <span class="st">&quot;new_folder&quot;</span></span></code></pre></div></li>
<li><p><strong>Nested Ensembles</strong></p>
<div class="sourceCode" id="cb95"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Database <span class="kw">{</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Connection management</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    :public object method connection.<span class="kw">open</span> <span class="kw">{</span>dbname<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[</span>::db::connect <span class="dt">$dbname</span><span class="kw">]</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Query operations</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    :public object method query.execute <span class="kw">{</span>sql<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[</span>::db::execute <span class="dt">$sql</span><span class="kw">]</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transaction management</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    :public object method transaction.begin <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>        ::db::begin</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    :public object method transaction.commit <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>        ::db::commit</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>Database connection <span class="kw">open</span> <span class="st">&quot;mydb&quot;</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>Database query execute <span class="st">&quot;SELECT * FROM users&quot;</span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>Database transaction begin</span></code></pre></div></li>
<li><p><strong>Dynamic Ensemble Creation</strong></p>
<div class="sourceCode" id="cb96"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DynamicEnsemble <span class="kw">{</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    :public object method <span class="ot">add</span> <span class="kw">{</span>subcommand method<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>        :public object method <span class="dt">$subcommand</span> <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="dt">$method</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>DynamicEnsemble <span class="ot">add</span> <span class="st">&quot;greet&quot;</span> <span class="kw">{puts</span> <span class="st">&quot;Hello, World!&quot;</span><span class="kw">}</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>DynamicEnsemble greet</span></code></pre></div></li>
</ol>
<h4 id="best-practices-for-ensembles">Best Practices for Ensembles</h4>
<ol type="1">
<li><p><strong>Clear Naming</strong></p>
<div class="sourceCode" id="cb97"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ConfigManager <span class="kw">{</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use descriptive subcommand names</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    :public object method config.<span class="kw">load</span> <span class="kw">{</span>filename<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">source</span> <span class="dt">$filename</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    :public object method config.save <span class="kw">{</span>filename<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save configuration</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Consistent Structure</strong></p>
<div class="sourceCode" id="cb98"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Logger <span class="kw">{</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group related operations</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    :public object method log.<span class="kw">info</span> <span class="kw">{message}</span> <span class="kw">{</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;INFO: </span><span class="dt">$</span><span class="st">message&quot;</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    :public object method log.<span class="kw">error</span> <span class="kw">{message}</span> <span class="kw">{</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;ERROR: </span><span class="dt">$</span><span class="st">message&quot;</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    :public object method log.<span class="ot">debug</span> <span class="kw">{message}</span> <span class="kw">{</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;DEBUG: </span><span class="dt">$</span><span class="st">message&quot;</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Error Handling</strong></p>
<div class="sourceCode" id="cb99"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> SafeEnsemble <span class="kw">{</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    :public object method operation.perform <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>        try <span class="kw">{</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Perform operation</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">[eval</span> <span class="dt">$args</span><span class="kw">]</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span> trap <span class="kw">{</span>NSF LOOKUP METHOD<span class="kw">}</span> <span class="kw">{</span>err opts<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">error</span> <span class="st">&quot;Unknown operation: [lindex </span><span class="dt">$</span><span class="st">args 0]&quot;</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h3 id="object-copying">Object Copying</h3>
<p>The NX/NSF system provides powerful object copying capabilities that
allow you to create duplicates of objects with various options:</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an original object</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Template <span class="kw">{</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    :property config</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>        :<span class="ot">configure -name</span> <span class="st">&quot;Default&quot;</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>        :<span class="ot">configure -config</span> <span class="kw">{</span>color blue <span class="ot">size</span> large<span class="kw">}</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and copy objects</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> original <span class="kw">[</span>Template new<span class="kw">]</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">copy</span> <span class="kw">[</span><span class="dt">$original</span> <span class="ot">copy</span><span class="kw">]</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy with new name</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> namedCopy <span class="kw">[</span><span class="dt">$original</span> <span class="ot">copy</span> <span class="st">&quot;myNewTemplate&quot;</span><span class="kw">]</span></span></code></pre></div>
<h4 id="copying-features">Copying Features</h4>
<ol type="1">
<li><p><strong>Basic Object Copying</strong></p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DataObject <span class="kw">{</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    :property data</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    :method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        :<span class="ot">configure -data</span> <span class="kw">{}</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and copy</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> obj1 <span class="kw">[</span>DataObject new<span class="ot"> -data</span> <span class="kw">{</span><span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span><span class="kw">}]</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> obj2 <span class="kw">[</span><span class="dt">$obj1</span> <span class="ot">copy</span><span class="kw">]</span></span></code></pre></div></li>
<li><p><strong>Deep Copying</strong></p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Container <span class="kw">{</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    :property<span class="ot"> -incremental</span> <span class="kw">{</span>items:object,*<span class="kw">}</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">copy</span> <span class="kw">{</span>?newName?<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> item <span class="kw">[</span>:<span class="ot">get</span> items<span class="kw">]</span> <span class="kw">{</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$new</span> items <span class="ot">add</span> <span class="kw">[</span><span class="dt">$item</span> <span class="ot">copy</span><span class="kw">]</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Selective Copying</strong></p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Configurable <span class="kw">{</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    :property settings</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    :property internal</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">copy</span> <span class="kw">{</span>?newName?<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Only copy specific properties</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -name</span> <span class="kw">[</span>:<span class="ot">get</span> <span class="ot">name</span><span class="kw">]</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -settings</span> <span class="kw">[</span>:<span class="ot">get</span> settings<span class="kw">]</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="copying-best-practices">Copying Best Practices</h4>
<ol type="1">
<li><p><strong>Property Handling</strong></p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ComplexObject <span class="kw">{</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    :property data</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    :property metadata</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">copy</span> <span class="kw">{</span>?newName?<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle each property appropriately</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -data</span> <span class="kw">[</span>:<span class="ot">get</span> data<span class="kw">]</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -metadata</span> <span class="kw">[dict</span> <span class="ot">create</span> <span class="kw">{</span>*<span class="kw">}[dict</span> <span class="ot">get</span> <span class="kw">[</span>:<span class="ot">get</span> metadata<span class="kw">]</span> <span class="ot">copy</span><span class="kw">]]</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Relationship Management</strong></p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Parent <span class="kw">{</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    :property<span class="ot"> -incremental</span> <span class="kw">{</span><span class="ot">children</span>:object,*<span class="kw">}</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">copy</span> <span class="kw">{</span>?newName?<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copy relationships</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> child <span class="kw">[</span>:<span class="ot">get</span> <span class="ot">children</span><span class="kw">]</span> <span class="kw">{</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$new</span> <span class="ot">children</span> <span class="ot">add</span> <span class="kw">[</span><span class="dt">$child</span> <span class="ot">copy</span><span class="kw">]</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Resource Management</strong></p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ResourceHolder <span class="kw">{</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> resourceHandle</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">copy</span> <span class="kw">{</span>?newName?<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create new resource handle</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> newHandle <span class="kw">[</span>::<span class="kw">resource</span>::<span class="ot">create</span><span class="kw">]</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -resourceHandle</span> <span class="dt">$newHandle</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="common-copying-patterns">Common Copying Patterns</h4>
<ol type="1">
<li><p><strong>Template-Based Copying</strong></p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DocumentTemplate <span class="kw">{</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    :property content</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">style</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    :method createFromTemplate <span class="kw">{</span><span class="ot">name</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>: <span class="ot">copy</span> <span class="dt">$name</span><span class="kw">]</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -content</span> <span class="kw">[</span>:<span class="ot">get</span> content<span class="kw">]</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Configuration Copying</strong></p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ConfigurableObject <span class="kw">{</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    :property settings</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    :method copyWithSettings <span class="kw">{</span>newName settings<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> new <span class="kw">[</span>: <span class="ot">copy</span> <span class="dt">$newName</span><span class="kw">]</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">$new</span> <span class="ot">configure -settings</span> <span class="dt">$settings</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$new</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>State Preservation</strong> ```tcl nx::Class create
StatefulObject { :variable state</p>
<pre><code> :method copy {?newName?} {
     set new [next]
     # Preserve state
     $new configure -state [:get state]
     return $new
 }</code></pre>
<p>} ```</p></li>
</ol>
<h3 id="serialization">Serialization</h3>
<p>The NX/NSF system provides comprehensive serialization capabilities
through the <code>nx::serializer</code> package, allowing objects to be
converted to and from a serialized format.</p>
<h4 id="basic-serialization">Basic Serialization</h4>
<div class="sourceCode" id="cb110"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize an object</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>object serialize<span class="kw">]</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Eval the script to recreate the object</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="kw">eval</span> <span class="dt">$script</span></span></code></pre></div>
<h4 id="target-mapping">Target Mapping</h4>
<div class="sourceCode" id="cb111"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize an object with a target mapping (different name/namespace)</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>object serialize<span class="ot"> -target</span> NewObjectName<span class="kw">]</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The serialized object will be created with the new target name</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="kw">eval</span> <span class="dt">$script</span></span></code></pre></div>
<h4 id="deep-serialization">Deep Serialization</h4>
<div class="sourceCode" id="cb112"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize an object and all its children</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize object<span class="kw">]</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recreate the object hierarchy</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="kw">eval</span> <span class="dt">$script</span></span></code></pre></div>
<h4 id="name-mapping-in-deep-serialization">Name Mapping in Deep
Serialization</h4>
<div class="sourceCode" id="cb113"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remap object names during serialization</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -map</span> <span class="kw">{</span>::old::<span class="ot">name</span> ::new::<span class="ot">name</span><span class="kw">}</span> object<span class="kw">]</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example with multiple mappings</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -map</span> <span class="kw">{</span>::a::b ::<span class="ot">x</span>::<span class="ot">y</span> ::a ::<span class="ot">x</span><span class="kw">}</span> ::a<span class="kw">]</span></span></code></pre></div>
<h4 id="variable-filtering">Variable Filtering</h4>
<div class="sourceCode" id="cb114"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore no variables (serialize all)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignoreVarsRE</span> <span class="st">&quot;&quot;</span> object<span class="kw">]</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore variables matching a pattern</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignoreVarsRE</span> <span class="st">&quot;pattern&quot;</span> object<span class="kw">]</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore all variables</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignoreVarsRE</span> <span class="st">&quot;.&quot;</span> object<span class="kw">]</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Specific variable filtering examples:</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore variables ending with &#39;a&#39;</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignoreVarsRE</span> <span class="kw">{</span>::a$<span class="kw">}</span> object<span class="kw">]</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude specific slot names</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">names</span> <span class="kw">{}</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> s <span class="kw">[</span>Class <span class="kw">info</span> slots<span class="kw">]</span> <span class="kw">{</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">lappend</span> <span class="ot">names</span> <span class="kw">[</span><span class="dt">$s</span> <span class="ot">cget -name</span><span class="kw">]</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignoreVarsRE</span> <span class="kw">[join</span> <span class="dt">$names</span> |<span class="kw">]</span> object<span class="kw">]</span></span></code></pre></div>
<h4 id="object-exclusion">Object Exclusion</h4>
<div class="sourceCode" id="cb115"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize a parent object but exclude a specific child</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer deepSerialize<span class="ot"> -ignore</span> ::<span class="ot">parent</span>::child ::<span class="ot">parent</span><span class="kw">]</span></span></code></pre></div>
<h4 id="slot-container-preservation">Slot Container Preservation</h4>
<p>Serialization preserves slot containers and their relationships:</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Class with properties</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> C <span class="kw">{</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  :object property <span class="ot">x</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  :property a</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Serializing preserves slot containers</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>C serialize<span class="kw">]</span></span></code></pre></div>
<h4 id="property-preservation">Property Preservation</h4>
<p>Serialization preserves important object properties:</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set object properties</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>::nsf::object::property ::object keepcallerself <span class="dv">1</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>::nsf::object::property ::object perobjectdispatch <span class="dv">1</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Properties are preserved after serialization</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>object serialize<span class="kw">]</span></span></code></pre></div>
<h4 id="method-property-preservation">Method Property Preservation</h4>
<p>Method properties like <code>-debug</code> and
<code>-deprecated</code> are preserved:</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define methods with properties</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> o <span class="kw">{</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  :public object method<span class="ot"> -deprecated</span> method1 <span class="kw">{}</span> <span class="kw">{return</span> <span class="dv">1</span><span class="kw">}</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  :public object method<span class="ot"> -debug</span> method2 <span class="kw">{}</span> <span class="kw">{return</span> <span class="dv">1</span><span class="kw">}</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  :public alias<span class="ot"> -deprecated -debug</span> aliasName ::<span class="ot">command</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Properties are preserved after serialization</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>o serialize<span class="kw">]</span></span></code></pre></div>
<h4 id="method-serialization">Method Serialization</h4>
<div class="sourceCode" id="cb119"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize a specific method</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">script</span> <span class="kw">[</span>::Serializer methodSerialize object methodName <span class="st">&quot;&quot;</span><span class="kw">]</span></span></code></pre></div>
<h4 id="integration-with-xotcl">Integration with XOTcl</h4>
<div class="sourceCode" id="cb120"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># XOTcl compatibility</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> XOTcl</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> xotcl::serializer</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Serialize XOTcl class info</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>::Serializer methodSerialize ::xotcl::classInfo <span class="ot">default</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
<h4 id="best-practices-for-serialization">Best Practices for
Serialization</h4>
<ol type="1">
<li><p>Always check if the serialized object exists after
deserialization:</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>::nsf::object::<span class="ot">exists</span> ::object<span class="kw">}</span> <span class="dv">1</span></span></code></pre></div></li>
<li><p>Verify that properties and relationships are preserved:</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>::nsf::method::property object method property<span class="kw">}</span> value</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>::nsf::var::<span class="ot">get</span> object::slot property<span class="kw">}</span> value</span></code></pre></div></li>
<li><p>For renaming/remapping objects, use the <code>-map</code> option
with the <code>-target</code> option as needed</p></li>
<li><p>Use <code>-ignore</code> to exclude specific objects from
serialization</p></li>
<li><p>Use <code>-ignoreVarsRE</code> with regular expressions to filter
which variables are serialized</p></li>
</ol>
<h4 id="troubleshooting-serialization">Troubleshooting
Serialization</h4>
<ul>
<li>Check if the object hierarchy is correctly serialized with
<code>::nsf::object::exists</code></li>
<li>Verify slot containers are preserved in classes with
<code>::nx::isSlotContainer</code></li>
<li>Test forwarder targets after serialization with
<code>nsf::method::forward::property</code></li>
</ul>
<h3 id="advanced-features">Advanced Features</h3>
<p>The NX/NSF system provides several advanced features for
meta-programming and event handling:</p>
<h4 id="meta-programming">Meta-Programming</h4>
<div class="sourceCode" id="cb123"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MetaExample <span class="kw">{</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add methods dynamically</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    :public method addMethod <span class="kw">{</span><span class="ot">name</span> <span class="ot">body</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>        :public method <span class="dt">$name</span> <span class="kw">{}</span> <span class="dt">$body</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Introspection</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    :public method listMethods <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">[</span>:<span class="kw">info</span> methods<span class="kw">]</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> obj <span class="kw">[</span>MetaExample new<span class="kw">]</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> addMethod newMethod <span class="kw">{return</span> <span class="st">&quot;Dynamic method&quot;</span><span class="kw">}</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$obj</span> listMethods<span class="kw">]</span></span></code></pre></div>
<h4 id="event-handling">Event Handling</h4>
<div class="sourceCode" id="cb124"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Observable <span class="kw">{</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    :property<span class="ot"> -incremental</span> <span class="kw">{</span>observers:object,*<span class="kw">}</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    :method notify <span class="kw">{event</span> <span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> observer <span class="kw">[</span>:<span class="ot">get</span> observers<span class="kw">]</span> <span class="kw">{</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$observer</span> <span class="kw">update</span> <span class="dt">$event</span> <span class="kw">{</span>*<span class="kw">}</span><span class="dt">$args</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="design-patterns">Design Patterns</h4>
<ol type="1">
<li><p><strong>Singleton Pattern</strong></p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Singleton <span class="kw">{</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    :property instance:object,<span class="dv">0</span>..<span class="dv">1</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    :public object method getInstance <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{</span>!<span class="kw">[info</span> <span class="ot">exists</span> :instance<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">set</span> :instance <span class="kw">[</span>:new<span class="kw">]</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">${:instance}</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Factory Pattern</strong></p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ShapeFactory <span class="kw">{</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    :public object method <span class="ot">create</span> <span class="kw">{</span><span class="ot">type</span> <span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">switch</span> <span class="dt">$type</span> <span class="kw">{</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;circle&quot;</span> <span class="kw">{</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> <span class="kw">[</span>Circle new <span class="kw">{</span>*<span class="kw">}</span><span class="dt">$args</span><span class="kw">]</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rectangle&quot;</span> <span class="kw">{</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> <span class="kw">[</span>Rectangle new <span class="kw">{</span>*<span class="kw">}</span><span class="dt">$args</span><span class="kw">]</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>            <span class="ot">default</span> <span class="kw">{</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>                <span class="kw">error</span> <span class="st">&quot;Unknown shape type: </span><span class="dt">$</span><span class="st">type&quot;</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="advanced-meta-programming-examples">Advanced Meta-Programming
Examples</h4>
<ol type="1">
<li><p><strong>Dynamic Method Creation</strong></p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DynamicClass <span class="kw">{</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    :public method addMethod <span class="kw">{</span><span class="ot">name</span> <span class="ot">args</span> <span class="ot">body</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>        :public method <span class="dt">$name</span> <span class="dt">$args</span> <span class="dt">$body</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    :public method addProperty <span class="kw">{</span><span class="ot">name</span> defaultValue<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>        :property <span class="kw">[list</span> <span class="dt">$name</span> <span class="dt">$defaultValue</span><span class="kw">]</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> obj <span class="kw">[</span>DynamicClass new<span class="kw">]</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> addMethod greet <span class="kw">{puts</span> <span class="st">&quot;Hello, World!&quot;</span><span class="kw">}</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="dt">$obj</span> addProperty age <span class="dv">0</span></span></code></pre></div></li>
<li><p><strong>Method Wrapping</strong></p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MethodWrapper <span class="kw">{</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    :public method wrapMethod <span class="kw">{</span>obj methodName wrapper<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> original <span class="kw">[</span>::nsf::method::<span class="ot">body</span> <span class="dt">$obj</span> <span class="dt">$methodName</span><span class="kw">]</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>        ::nsf::method::<span class="ot">create</span> <span class="dt">$obj</span> <span class="dt">$methodName</span> <span class="kw">[subst</span> <span class="kw">{</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$wrapper</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$original</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}]</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> wrapper <span class="kw">[</span>MethodWrapper new<span class="kw">]</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="dt">$wrapper</span> wrapMethod <span class="dt">$obj</span> methodName <span class="kw">{</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">puts</span> <span class="st">&quot;Before method call&quot;</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Property Observer</strong></p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> PropertyObserver <span class="kw">{</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    :public method observeProperty <span class="kw">{</span>obj propertyName callback<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>        ::nsf::property::setter <span class="dt">$obj</span> <span class="dt">$propertyName</span> <span class="kw">[subst</span> <span class="kw">{</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">set</span> oldValue <span class="kw">[</span>::nsf::property::<span class="ot">get</span> <span class="kw">[</span>self<span class="kw">]</span> <span class="dt">$propertyName</span><span class="kw">]</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>            ::nsf::property::<span class="kw">set</span> <span class="kw">[</span>self<span class="kw">]</span> <span class="dt">$propertyName</span> <span class="ch">\$</span>value</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">$callback</span> <span class="kw">[</span>self<span class="kw">]</span> <span class="dt">$propertyName</span> <span class="ch">\$</span>oldValue <span class="ch">\$</span>value</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}]</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> observer <span class="kw">[</span>PropertyObserver new<span class="kw">]</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="dt">$observer</span> observeProperty <span class="dt">$obj</span> value <span class="kw">{</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">puts</span> <span class="st">&quot;Property changed from </span><span class="dt">$</span><span class="st">oldValue to </span><span class="dt">$</span><span class="st">newValue&quot;</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Class Mixin Manager</strong></p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MixinManager <span class="kw">{</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    :public method addMixin <span class="kw">{</span>obj mixin<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>        ::nsf::object::mixin <span class="ot">add</span> <span class="dt">$obj</span> <span class="dt">$mixin</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    :public method removeMixin <span class="kw">{</span>obj mixin<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>        ::nsf::object::mixin <span class="ot">remove</span> <span class="dt">$obj</span> <span class="dt">$mixin</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    :public method getMixins <span class="kw">{</span>obj<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>        ::nsf::object::mixin <span class="ot">get</span> <span class="dt">$obj</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="ot">manager</span> <span class="kw">[</span>MixinManager new<span class="kw">]</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="dt">$manager</span> addMixin <span class="dt">$obj</span> LoggingMixin</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="dt">$manager</span> addMixin <span class="dt">$obj</span> ValidationMixin</span></code></pre></div></li>
<li><p><strong>Method Profiler</strong> ```tcl nx::Class create
MethodProfiler { :variable timings</p>
<pre><code> :public method profileMethod {obj methodName} {
     set original [::nsf::method::body $obj $methodName]
     ::nsf::method::create $obj $methodName [subst {
         set start [clock microseconds]
         set result [uplevel 1 $original]
         set end [clock microseconds]
         set duration [expr {$end - $start}]
         lappend :timings($methodName) $duration
         return \$result
     }]
 }

 :public method getStats {methodName} {
     if {![info exists :timings($methodName)]} {
         return &quot;No data for $methodName&quot;
     }
     set times ${:timings($methodName)}
     set avg [expr {[tcl::mathop::+ {*}$times] / [llength $times]}]
     return &quot;Average time: ${avg}μs&quot;
 }</code></pre>
<p>}</p>
<p># Usage set profiler [MethodProfiler new] $profiler profileMethod
<span
class="math inline"><em>o</em><em>b</em><em>j</em><em>e</em><em>x</em><em>p</em><em>e</em><em>n</em><em>s</em><em>i</em><em>v</em><em>e</em><em>M</em><em>e</em><em>t</em><em>h</em><em>o</em><em>d</em><em>p</em><em>u</em><em>t</em><em>s</em>[</span>profiler
getStats expensiveMethod] ```</p></li>
</ol>
<h3 id="best-practices-2">Best Practices</h3>
<p>The NX/NSF system provides powerful features, but following best
practices is essential for maintainable and efficient code:</p>
<h4 id="object-system-design">1. Object System Design</h4>
<ol type="1">
<li><p><strong>Clear Hierarchy</strong></p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define clear class hierarchies</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Animal <span class="kw">{</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="ot">name</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    :property age</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Mammal<span class="ot"> -superclass</span> Animal <span class="kw">{</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    :property furColor</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Dog<span class="ot"> -superclass</span> Mammal <span class="kw">{</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    :property breed</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Method Organization</strong></p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> WellOrganized <span class="kw">{</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public interface</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    :public method publicMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>        :validateInput</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>        :processData</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>        :updateState</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Protected helpers</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    :protected method validateInput <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Validation logic</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private implementation</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    :private method processData <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processing logic</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Type Safety</strong></p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> TypeSafe <span class="kw">{</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">{</span>age:integer <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">{</span><span class="ot">name</span>:<span class="kw">string}</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    :property <span class="kw">{</span>active:boolean true<span class="kw">}</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    :method validateAge <span class="kw">{</span>age<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{</span><span class="dt">$age</span> &lt; <span class="dv">0</span> || <span class="dt">$age</span> &gt; <span class="dv">150</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">error</span> <span class="st">&quot;Invalid age: </span><span class="dt">$</span><span class="st">age&quot;</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$age</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="meta-programming-1">2. Meta-Programming</h4>
<ol type="1">
<li><p><strong>Introspection</strong></p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cache introspection results</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> EfficientClass <span class="kw">{</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> methodCache</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    :method getMethods <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{</span>!<span class="kw">[info</span> <span class="ot">exists</span> :methodCache<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">set</span> :methodCache <span class="kw">[</span>:<span class="kw">info</span> methods<span class="kw">]</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">${:methodCache}</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Dynamic Features</strong></p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> DynamicFeatures <span class="kw">{</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> generatedMethods</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    :method addDynamicMethod <span class="kw">{</span><span class="ot">name</span> <span class="ot">body</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{[info</span> <span class="ot">exists</span> :generatedMethods(<span class="dt">$name</span>)<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">error</span> <span class="st">&quot;Method </span><span class="dt">$</span><span class="st">name already exists&quot;</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>        :public method <span class="dt">$name</span> <span class="kw">{}</span> <span class="dt">$body</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> :generatedMethods(<span class="dt">$name</span>) <span class="dv">1</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Aspect-Oriented</strong></p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> AspectOriented <span class="kw">{</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    :method addLogging <span class="kw">{</span>methodName<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> original <span class="kw">[</span>::nsf::method::<span class="ot">body</span> <span class="kw">[</span>self<span class="kw">]</span> <span class="dt">$methodName</span><span class="kw">]</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>        ::nsf::method::<span class="ot">create</span> <span class="kw">[</span>self<span class="kw">]</span> <span class="dt">$methodName</span> <span class="kw">[subst</span> <span class="kw">{</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>            <span class="kw">puts</span> <span class="st">&quot;Entering </span><span class="dt">$</span><span class="st">methodName&quot;</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">set</span> result <span class="kw">[uplevel</span> <span class="dv">1</span> <span class="dt">$original</span><span class="kw">]</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">puts</span> <span class="st">&quot;Exiting </span><span class="dt">$</span><span class="st">methodName&quot;</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="ch">\$</span>result</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}]</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="error-handling">3. Error Handling</h4>
<ol type="1">
<li><p><strong>Error Prevention</strong></p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> SafeClass <span class="kw">{</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">configure</span> <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{[catch</span> <span class="kw">{</span>next<span class="kw">}</span> result<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">error</span> <span class="st">&quot;Configuration failed: </span><span class="dt">$</span><span class="st">result&quot;</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$result</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Error Recovery</strong></p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ResilientClass <span class="kw">{</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    :method performOperation <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>        try <span class="kw">{</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>            :validateState</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>            :executeOperation</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span> finally <span class="kw">{</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>            :cleanup</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Error Reporting</strong></p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> InformativeClass <span class="kw">{</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>    :method handleError <span class="kw">{</span>operation <span class="kw">error}</span> <span class="kw">{</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;Error in </span><span class="dt">$</span><span class="st">operation: </span><span class="dt">$</span><span class="st">error&quot;</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;Stack trace: [info stacktrace]&quot;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">error</span> <span class="dt">$error</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="performance-optimization">4. Performance Optimization</h4>
<ol type="1">
<li><p><strong>Method Caching</strong></p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> CachedClass <span class="kw">{</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> cache</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    :method expensiveOperation <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> key <span class="kw">[join</span> <span class="dt">$args</span> <span class="st">&quot;,&quot;</span><span class="kw">]</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{[info</span> <span class="ot">exists</span> :cache(<span class="dt">$key</span>)<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="dt">${:cache($key)}</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> result <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span> :cache(<span class="dt">$key</span>) <span class="dt">$result</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">$result</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Resource Management</strong></p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> ResourceManager <span class="kw">{</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> resources</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    :method acquire <span class="kw">{resource}</span> <span class="kw">{</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{</span>!<span class="kw">[info</span> <span class="ot">exists</span> :resources(<span class="dt">$resource</span>)<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">set</span> :resources(<span class="dt">$resource</span>) <span class="kw">[</span>::<span class="kw">resource</span>::<span class="ot">create</span> <span class="dt">$resource</span><span class="kw">]</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="dt">${:resources($resource)}</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    :method <span class="ot">release</span> <span class="kw">{resource}</span> <span class="kw">{</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="kw">{[info</span> <span class="ot">exists</span> :resources(<span class="dt">$resource</span>)<span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>            ::<span class="kw">resource</span>::<span class="kw">destroy</span> <span class="dt">${:resources($resource)}</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">unset</span> :resources(<span class="dt">$resource</span>)</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Memory Management</strong></p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MemoryEfficient <span class="kw">{</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    :method cleanup <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> var <span class="kw">[info</span> <span class="ot">vars</span> :*<span class="kw">]</span> <span class="kw">{</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="kw">{[info</span> <span class="ot">exists</span> <span class="dt">$var</span><span class="kw">]}</span> <span class="kw">{</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>                <span class="kw">unset</span> <span class="dt">$var</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h2 id="nsf-core-architecture">NSF Core Architecture</h2>
<h3 id="foundation-components">Foundation Components</h3>
<p>The NSF system is built on three fundamental components that work
together to provide a robust object-oriented programming
environment:</p>
<ol type="1">
<li><strong>NsfObject</strong>
<ul>
<li>Core object representation</li>
<li>Contains command name, namespace, and class references</li>
<li>Manages instance variables and method dispatch</li>
</ul></li>
<li><strong>NsfClass</strong>
<ul>
<li>Class representation</li>
<li>Manages superclass/subclass relationships</li>
<li>Handles method resolution order</li>
<li>Controls instance creation and initialization</li>
</ul></li>
<li><strong>NsfObjectSystem</strong>
<ul>
<li>Container for classes and objects</li>
<li>Manages root class and meta-class</li>
<li>Controls object system lifecycle</li>
</ul></li>
</ol>
<h3 id="plain-object-method-package">Plain Object Method Package</h3>
<p>The <code>nx::plain-object-method</code> package provides a
convenience layer for Next Scripting Framework (NX) that enables
object-oriented functionality directly on plain objects. This package is
essential for working with plain objects in NX.</p>
<h4 id="loading-and-configuration">Loading and Configuration</h4>
<div class="sourceCode" id="cb144"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> nx::plain-object-method</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure warnings</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>nx::<span class="ot">configure</span> plain-object-method-warning on  # Enable warnings</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>nx::<span class="ot">configure</span> plain-object-method-warning off # Disable warnings</span></code></pre></div>
<h4 id="object-creation-and-methods">Object Creation and Methods</h4>
<div class="sourceCode" id="cb145"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a basic object</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define methods, properties, and variables here</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define methods with different protection levels</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Public method</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    :public method foo <span class="kw">{}</span> <span class="kw">{return</span> foo<span class="kw">}</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Protected method</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    :protected method pm1 <span class="ot">args</span> <span class="kw">{return</span> pm1<span class="kw">}</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private method</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>    :private method priv <span class="ot">args</span> <span class="kw">{return</span> priv<span class="kw">}</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Default method (protected)</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>    :method pm2 <span class="ot">args</span> <span class="kw">{return</span> pm2<span class="kw">}</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Object method</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>    :public object method f <span class="ot">args</span> <span class="kw">{</span>next<span class="kw">}</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="method-aliases-and-forwarding">Method Aliases and
Forwarding</h4>
<div class="sourceCode" id="cb146"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create an alias to another method</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    :public alias a ::o::pm1</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a forwarding method</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    :public forward fwd %self pm1</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="properties-and-variables">Properties and Variables</h4>
<div class="sourceCode" id="cb147"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Property with public accessor</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    :property<span class="ot"> -accessor</span> public p</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simple variable</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span> v1 <span class="dv">1</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Incremental variable with type constraint</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>    :<span class="kw">variable</span><span class="ot"> -incremental</span> v2:integer <span class="dv">1</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="mixins-and-filters-1">Mixins and Filters</h4>
<div class="sourceCode" id="cb148"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mixin class</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> M1</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a mixin</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>o mixins <span class="kw">set</span> M1</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check mixins</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> mixins</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear mixins</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>o mixins <span class="kw">set</span> <span class="st">&quot;&quot;</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a filter</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>o filters <span class="kw">set</span> f</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check filters</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> filters</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear filters</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>o filters <span class="kw">set</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
<h4 id="information-retrieval">Information Retrieval</h4>
<div class="sourceCode" id="cb149"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all methods</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> methods</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List methods with specific protection level</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> methods<span class="ot"> -callprotection</span> protected</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> methods<span class="ot"> -callprotection</span> private</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co"># List object methods</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> object methods</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co"># List all variables</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> variables</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co"># List object variables</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> object variables</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co"># List all slots (variables and properties)</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> slots</span></code></pre></div>
<h4 id="method-and-property-management">Method and Property
Management</h4>
<div class="sourceCode" id="cb150"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete a method</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">delete</span> method foo</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete a property</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>o <span class="ot">delete</span> property p</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete a variable</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>o <span class="ot">delete</span> <span class="kw">variable</span> v1</span></code></pre></div>
<h4 id="advanced-features-1">Advanced Features</h4>
<div class="sourceCode" id="cb151"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide a method implementation</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>nsf::method::<span class="ot">provide</span> <span class="kw">set</span> <span class="kw">{</span>::nsf::method::alias <span class="kw">set</span><span class="ot"> -frame</span> object ::<span class="kw">set}</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Require a method in an object</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    :<span class="ot">require</span> method <span class="kw">set</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="behavior-without-plain-object-method">Behavior Without
Plain-Object-Method</h4>
<p>Without loading the <code>nx::plain-object-method</code> package, the
following operations fail: - <code>o public method foo {}</code> -
<code>o mixins set M1</code> - <code>o filters set f</code></p>
<p>After loading the package, these operations become available to plain
objects.</p>
<h3 id="runtime-assertion-checking-rac">Runtime Assertion Checking
(RAC)</h3>
<p>Runtime Assertion Checking (RAC) is a powerful feature in NX that
allows for runtime validation of correctness conditions, based on the
conceptual baseline of the Eiffel specification (ECMA Standard 367, 2nd
edition, 2006).</p>
<h4 id="basic-concepts-1">Basic Concepts</h4>
<p>RAC in NX implements several key assertion types: - <strong>Class
invariants</strong>: Conditions that must hold true for all instances of
a class - <strong>Object invariants</strong>: Conditions that must hold
true for a specific object - <strong>Preconditions</strong>: Conditions
that must be true before a method executes -
<strong>Postconditions</strong>: Conditions that must be true after a
method executes</p>
<h4 id="assertion-types-and-syntax">Assertion Types and Syntax</h4>
<ol type="1">
<li><strong>Class Invariants</strong></li>
</ol>
<div class="sourceCode" id="cb152"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> MyClass<span class="ot"> -invariant</span> <span class="kw">{</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># invariant_name: <span class="kw">}</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:property1}</span> &gt;= <span class="dt">${:property2}</span><span class="kw">}</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># class definition...</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Object Invariants</strong></li>
</ol>
<div class="sourceCode" id="cb153"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>MyObject <span class="ot">configure -object</span>-invariant <span class="kw">{</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:property}</span> &gt; <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Method Preconditions and Postconditions</strong></li>
</ol>
<div class="sourceCode" id="cb154"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>MyClass public method myMethod <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># method body</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span><span class="ot"> -precondition</span> <span class="kw">{</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># pre_condition_name: <span class="kw">}</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:property}</span> &gt; <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span><span class="ot"> -postcondition</span> <span class="kw">{</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># post_condition_name: <span class="kw">}</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:property}</span> &gt; <span class="dt">${:anotherProperty}</span><span class="kw">}</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="setting-up-assertions">Setting Up Assertions</h4>
<ol type="1">
<li><strong>Class Invariants</strong></li>
</ol>
<div class="sourceCode" id="cb155"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct interface</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion MyClass <span class="ot">class</span>-invar <span class="dt">$invariantList</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Object interface</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>MyClass <span class="ot">configure -invariant</span> <span class="dt">$invariantList</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Object Invariants</strong></li>
</ol>
<div class="sourceCode" id="cb156"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct interface</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject object-invar <span class="dt">$invariantList</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Object interface</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>myObject <span class="ot">configure -object</span>-invariant <span class="dt">$invariantList</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Reading Invariants</strong></li>
</ol>
<div class="sourceCode" id="cb157"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get class invariant</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>MyClass <span class="ot">cget -invariant</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get object invariant</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>myObject <span class="ot">cget -object</span>-invariant</span></code></pre></div>
<h4 id="activatingdeactivating-assertions">Activating/Deactivating
Assertions</h4>
<p>Assertions can be selectively activated or deactivated:</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate all assertions for an object</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject check all</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate only preconditions</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject check pre</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate only postconditions</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject check <span class="ot">post</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate only class invariants</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject check <span class="ot">class</span>-invar</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Deactivate all assertions for an object</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>::nsf::method::assertion myObject check <span class="kw">{}</span></span></code></pre></div>
<h4 id="assertion-evaluation-order">Assertion Evaluation Order</h4>
<p>The actual evaluation order in NX:</p>
<pre><code>Entry -&gt; PRE -&gt; INVAR -&gt; (METHOD BODY) -&gt; POST -&gt; INVAR -&gt; Exit</code></pre>
<p>Expected order according to ECMA-367 §8.23.26:</p>
<pre><code>Entry -&gt; INVAR -&gt; PRE -&gt; (METHOD BODY) -&gt; INVAR -&gt; POST -&gt; Exit</code></pre>
<h4 id="inheritance-and-assertions">Inheritance and Assertions</h4>
<ol type="1">
<li><strong>Invariants</strong></li>
</ol>
<ul>
<li>Child class invariants include parent invariants</li>
<li>Invariants are joined with logical AND</li>
<li>Parent clauses take precedence in reverse linearization order</li>
</ul>
<ol start="2" type="1">
<li><strong>Preconditions</strong></li>
</ol>
<ul>
<li>Preconditions should weaken in subclasses</li>
<li>Preconditions are joined with logical OR</li>
<li>Parent clauses take precedence in reverse linearization order</li>
<li>The rule for preconditions is “require else” (OR joining)</li>
</ul>
<ol start="3" type="1">
<li><strong>Postconditions</strong></li>
</ol>
<ul>
<li>Postconditions should strengthen in subclasses</li>
<li>Postconditions are joined with logical AND</li>
<li>Parent clauses take precedence in reverse linearization order</li>
<li>The rule for postconditions is “ensure then” (AND joining)</li>
</ul>
<ol start="4" type="1">
<li><strong>Shadowing Methods</strong></li>
</ol>
<ul>
<li>Using <code>next</code> ensures proper execution of parent
assertions</li>
<li>Without <code>next</code>, parent assertions may not be properly
executed</li>
</ul>
<h4 id="limitations-and-issues">Limitations and Issues</h4>
<ol type="1">
<li>Error reporting does not clearly distinguish between assertion
failures and underlying errors</li>
<li>When invariant assertions fail, the object state might still be
modified effectively</li>
<li>Class invariants are not evaluated after instance creation by
default</li>
<li>The order of resolution for class invariants in the inheritance
hierarchy is not always correct</li>
<li>Class invariants are not checked before preconditions as expected by
the Eiffel specification</li>
<li>Proper access to method arguments in assertion expressions is
needed</li>
<li>Parameter type checks should be performed before precondition and
invariant checks</li>
<li>Error messages can be misleading (“in proc ‘v’” for invariant
failures)</li>
</ol>
<h4 id="usage-examples">Usage Examples</h4>
<ol type="1">
<li><strong>Basic Class with Invariant</strong></li>
</ol>
<div class="sourceCode" id="cb161"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> Account<span class="ot"> -invariant</span> <span class="kw">{</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># sufficient_balance: <span class="kw">}</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:balance}</span> &gt;= <span class="dt">${:minimumBalance}</span><span class="kw">}</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  :property<span class="ot"> -accessor</span> public balance:integer</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  :property<span class="ot"> -accessor</span> public minimumBalance:integer</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Method with Preconditions and Postconditions</strong></li>
</ol>
<div class="sourceCode" id="cb162"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>Account public method deposit <span class="kw">{</span>sum:integer<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">incr</span> :depositTransactions</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">incr</span> :balance <span class="dt">$sum</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span><span class="ot"> -precondition</span> <span class="kw">{</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># deposit_positive: <span class="kw">}</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">$sum</span> &gt; <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span><span class="ot"> -postcondition</span> <span class="kw">{</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># balance_increased: <span class="kw">}</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:balance}</span> &gt; <span class="dv">0</span><span class="kw">}</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Inheritance Example</strong></li>
</ol>
<div class="sourceCode" id="cb163"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> SavingsAccount<span class="ot"> -superclass</span> Account<span class="ot"> -invariant</span> <span class="kw">{</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span># minimum_deposit: <span class="kw">}</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">{</span><span class="dt">${:minimumBalance}</span> &gt; <span class="dv">100</span><span class="kw">}</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="references">References</h4>
<ul>
<li>ECMA Standard 367, 2nd edition (2006):
https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-367.pdf</li>
</ul>
<h3 id="the-nxsh-shell-and-testing-framework">The nxsh Shell and Testing
Framework</h3>
<p>The nxsh shell is a Tcl shell with Next Scripting Framework
extensions, providing a command-line interface for NX/NSF development
and testing.</p>
<h4 id="environment-requirements">Environment Requirements</h4>
<ul>
<li>Non-Windows platforms (tests skip on Windows environments without
bash-like shells)</li>
<li>NSF compiled without memcount (tests skip when
<code>$::nsf::config(memcount) == 1</code>)</li>
</ul>
<h4 id="shell-initialization">Shell Initialization</h4>
<div class="sourceCode" id="cb164"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> rootDir <span class="kw">[file</span> <span class="kw">join</span> <span class="kw">{</span>*<span class="kw">}[lrange</span> <span class="kw">[file</span> <span class="kw">split</span> <span class="kw">[file</span> <span class="ot">normalize</span> <span class="kw">[info</span> <span class="ot">script</span><span class="kw">]]]</span> <span class="dv">0</span> end<span class="dv">-2</span><span class="kw">]]</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> nxsh <span class="kw">[file</span> <span class="kw">join</span> <span class="dt">$rootDir</span> nxsh<span class="kw">]</span></span></code></pre></div>
<h4 id="command-line-usage-patterns">Command Line Usage Patterns</h4>
<ol type="1">
<li><p><strong>Interactive Mode</strong></p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>nxsh  # Launches interactive shell</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test: exec $nxsh &lt;&lt; &quot;$run; exit&quot; produces expected output</span></span></code></pre></div></li>
<li><p><strong>Script Execution</strong></p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>nxsh <span class="ot">script</span>.tcl  # Executes a Tcl <span class="ot">script</span> with nxsh</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>nxsh <span class="ot">script</span>.tcl arg1 arg2 ...  # Passes arguments to <span class="ot">script</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Script access to args: $argc (count), $argv (list of arguments)</span></span></code></pre></div></li>
<li><p><strong>Command Execution (-c option)</strong></p>
<div class="sourceCode" id="cb167"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>nxsh<span class="ot"> -c</span> <span class="st">&quot;command&quot;</span>  # Executes a single <span class="ot">command</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>nxsh<span class="ot"> -c</span> <span class="st">&quot;command&quot;</span> arg1 arg2 ...  # Executes <span class="ot">command</span> with arguments</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>nxsh<span class="ot"> -c</span> &lt;&lt; <span class="st">&quot;command&quot;</span>  # Executes <span class="ot">command</span> from stdin</span></code></pre></div></li>
</ol>
<h4 id="test-framework">Test Framework</h4>
<p>The nxsh shell testing framework is implemented using the
<code>nx::test</code> framework and consists of a single test case
called <code>nxsh</code>.</p>
<h5 id="test-cases">Test Cases</h5>
<ol type="1">
<li><p><strong>File Operations</strong></p>
<ul>
<li>Verifies nxsh executable exists and is executable</li>
<li>Tests temporary file creation and execution</li>
<li>Tests error handling for non-existent files</li>
</ul></li>
<li><p><strong>Command Line Arguments</strong></p>
<ul>
<li>Checks argument passing and handling</li>
<li>Tests <code>$argc</code> and <code>$argv</code> handling</li>
</ul></li>
<li><p><strong>Exit Code Handling</strong></p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">exit</span> <span class="dv">0</span>  # Normal <span class="kw">exit</span>, no <span class="kw">error</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="kw">exit</span> <span class="dv">1</span>  # Abnormal <span class="kw">exit</span>, <span class="kw">error</span> reported</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="kw">exit</span> <span class="dv">2</span>  # Abnormal <span class="kw">exit</span>, <span class="kw">error</span> reported</span></code></pre></div></li>
<li><p><strong>Error Handling</strong></p>
<ul>
<li>Tests try/catch behavior with exit codes</li>
<li>Tests error handling within nx::Object contexts</li>
<li>Tests finally block execution</li>
</ul></li>
</ol>
<h5 id="utility-functions">Utility Functions</h5>
<div class="sourceCode" id="cb169"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract first line of command output</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> getFirstLine <span class="kw">{</span>cmd<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">catch</span> <span class="kw">[list</span> <span class="kw">uplevel</span> <span class="dv">1</span> <span class="dt">$cmd</span><span class="kw">]</span> res opts</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> lines <span class="kw">[split</span> <span class="dt">$res</span> <span class="ch">\n</span><span class="kw">]</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="kw">[string</span> <span class="ot">trim</span> <span class="kw">[lindex</span> <span class="dt">$lines</span> <span class="dv">0</span><span class="kw">]]</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h5 id="test-syntax">Test Syntax</h5>
<ul>
<li><code>?</code> command is used for assertions</li>
<li>Format: <code>? [test-command] expected-result</code></li>
</ul>
<h5 id="platform-specific-notes">Platform-Specific Notes</h5>
<ul>
<li>Compatible with Tcl 8.6 or newer for certain features</li>
<li>Uses shell I/O redirection (<code>&lt;&lt;</code>) to provide input
to nxsh</li>
<li>Special handling for stderr with <code>-ignorestderr</code>
option</li>
</ul>
<h5 id="common-test-patterns">Common Test Patterns</h5>
<ol type="1">
<li><p><strong>Error Testing</strong></p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">[list</span> <span class="kw">exec</span> <span class="dt">$nxsh</span><span class="ot"> -c</span> <span class="st">&quot;exit 1&quot;</span><span class="kw">]</span> <span class="st">&quot;child process exited abnormally&quot;</span></span></code></pre></div></li>
<li><p><strong>Command Execution Testing</strong></p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">[list</span> <span class="kw">exec</span> <span class="dt">$nxsh</span><span class="ot"> -c</span> <span class="dt">$run</span> a b c<span class="kw">]</span> <span class="st">&quot;3-a-b-c&quot;</span></span></code></pre></div></li>
<li><p><strong>File Existence</strong></p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">[list</span> <span class="kw">file</span> <span class="ot">exists</span> <span class="dt">$nxsh</span><span class="kw">]</span> <span class="dv">1</span></span></code></pre></div></li>
</ol>
<h5 id="error-code-extraction">Error Code Extraction</h5>
<div class="sourceCode" id="cb173"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">[list</span> <span class="kw">catch</span> <span class="kw">[list</span> <span class="kw">exec</span> <span class="dt">$nxsh</span><span class="ot"> -c</span> <span class="st">&quot;exit 5&quot;</span><span class="kw">]</span> ::res ::opts<span class="kw">]</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{set</span> ::res<span class="kw">}</span> <span class="st">&quot;child process exited abnormally&quot;</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{lindex</span> <span class="kw">[dict</span> <span class="ot">get</span> <span class="dt">$::opts</span><span class="ot"> -errorcode</span><span class="kw">]</span> end<span class="kw">}</span> <span class="st">&quot;5&quot;</span></span></code></pre></div>
<h3 id="submethods">Submethods</h3>
<p>Submethods in NX (Next Scripting Framework) are hierarchical method
structures that allow creating command ensembles with multiple levels of
dispatch. This section covers the key concepts, syntax, and behaviors of
submethods.</p>
<h4 id="basic-syntax-1">Basic Syntax</h4>
<div class="sourceCode" id="cb174"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a submethod with space-separated path components</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>:object method <span class="st">&quot;string length&quot;</span> <span class="ot">x</span> <span class="kw">{return</span> <span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>:object method <span class="st">&quot;foo a x&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> <span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For class methods</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;bar m1&quot;</span> <span class="kw">{</span>a:integer<span class="ot"> -flag</span><span class="kw">}</span> <span class="kw">{</span>;<span class="kw">}</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;baz a m1&quot;</span> <span class="kw">{</span><span class="ot">x</span>:integer<span class="ot"> -y</span>:boolean<span class="kw">}</span> <span class="kw">{return</span> m1<span class="kw">}</span></span></code></pre></div>
<h4 id="calling-submethods">Calling Submethods</h4>
<div class="sourceCode" id="cb175"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard submethod call</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>obj foo a <span class="ot">x</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using colon notation for object-local calls</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">eval</span> <span class="kw">{</span> :foo a <span class="ot">x</span> <span class="kw">}</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using colon prefix (alternative syntax)</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">eval</span> <span class="kw">{</span> : foo a <span class="ot">x</span> <span class="kw">}</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Local call with -local flag (for private methods)</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">eval</span> <span class="kw">{</span> :<span class="ot"> -local</span> foo a <span class="ot">x</span> <span class="kw">}</span></span></code></pre></div>
<h4 id="error-handling-and-discovery">Error Handling and Discovery</h4>
<p>When a submethod cannot be found, NX provides helpful error
messages:</p>
<pre><code>unable to dispatch sub-method &quot;z&quot; of ::obj foo a; valid are: foo a defaultmethod, foo a subcmdName, foo a unknown, foo a x, foo a y</code></pre>
<p>To list available submethods:</p>
<div class="sourceCode" id="cb177"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns: &quot;valid submethods of ::obj string: info length tolower&quot;</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>obj <span class="kw">string</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use lsort to get an alphabetical list of available submethods</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="kw">lsort</span> <span class="kw">[</span>obj <span class="kw">info</span> has<span class="kw">]</span></span></code></pre></div>
<h4 id="introspection-in-submethods">Introspection in Submethods</h4>
<div class="sourceCode" id="cb178"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the current method name</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> method<span class="kw">]</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the current class</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> <span class="ot">class</span><span class="kw">]</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the full method path</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get current method arguments</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> <span class="ot">args</span><span class="kw">]</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the current object</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span>self<span class="kw">]</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the calling class</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> callingclass<span class="kw">]</span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the calling object</span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> callingobject<span class="kw">]</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the calling method</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> callingmethod<span class="kw">]</span></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the next method in the chain</span></span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> nextmethod<span class="kw">]</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if current call is from next</span></span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> isnextcall<span class="kw">]</span></span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the method that was called</span></span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> calledmethod<span class="kw">]</span></span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the class of the called method</span></span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span> calledclass<span class="kw">]</span></span></code></pre></div>
<h4 id="using-next-with-submethods">Using <code>next</code> with
Submethods</h4>
<div class="sourceCode" id="cb179"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic next usage in a submethod</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;foo a&quot;</span> <span class="kw">{</span><span class="ot">x</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Do something</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  nx::next</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Passing arguments to next</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;foo a&quot;</span> <span class="kw">{}</span> <span class="kw">{</span>next <span class="dv">42</span><span class="kw">}</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Collecting results from next</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> result <span class="kw">[</span>next<span class="kw">]</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Appending next results to your own</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="kw">return</span> <span class="kw">[list</span> <span class="st">&quot;My result&quot;</span> <span class="kw">{</span>*<span class="kw">}[</span>next<span class="kw">]]</span></span></code></pre></div>
<p>A “leaf next” is a next call at the end of the method resolution
chain:</p>
<div class="sourceCode" id="cb180"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>:public object method <span class="st">&quot;FOO bar&quot;</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">incr</span> :<span class="ot">x</span>; next;  <span class="co"># a &quot;leaf next&quot; - won&#39;t trigger unknown handling</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="method-protection-and-visibility-1">Method Protection and
Visibility</h4>
<div class="sourceCode" id="cb181"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Public submethod</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>:public method <span class="st">&quot;foo a&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> something<span class="kw">}</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Private submethod</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>:private method <span class="st">&quot;bar x&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> something<span class="kw">}</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Protected submethod</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>:protected method <span class="st">&quot;baz y&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> something<span class="kw">}</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Local calls to private methods</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>:public method some_method <span class="kw">{}</span> <span class="kw">{</span>:<span class="ot"> -local</span> private_method<span class="kw">}</span></span></code></pre></div>
<h4 id="variable-access-in-ensemble-methods">Variable Access in Ensemble
Methods</h4>
<div class="sourceCode" id="cb182"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regular upvar - doesn&#39;t work across ensemble boundaries</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;bar0 x&quot;</span> <span class="kw">{</span>varname<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">upvar</span> <span class="dt">$varname</span> v</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="kw">[info</span> <span class="ot">exists</span> v<span class="kw">]</span>  # Returns <span class="dv">0</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co"># NX-specific upvar - works across ensemble boundaries</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>:method <span class="st">&quot;bar1 x&quot;</span> <span class="kw">{</span>varname<span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  :<span class="kw">upvar</span> <span class="dt">$varname</span> v  # Note the colon prefix</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="kw">[info</span> <span class="ot">exists</span> v<span class="kw">]</span>  # Returns <span class="dv">1</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="method-forwarding-with-submethods">Method Forwarding with
Submethods</h4>
<div class="sourceCode" id="cb183"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward to a command with submethods</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>:public object forward link1 <span class="kw">{</span>%<span class="kw">[</span>self<span class="kw">]</span>::child<span class="kw">}</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward to a child object</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>:public object forward link2 :child</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Method-based forwarding</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>:public object method link3 <span class="ot">args</span> <span class="kw">{[</span>self<span class="kw">]</span>::child <span class="kw">{</span>*<span class="kw">}</span><span class="dt">$args</span><span class="kw">}</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Alias forwarding</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>:public object alias link4 <span class="kw">[</span>self<span class="kw">]</span>::child</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct object forwarding</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>:public object forward link5 <span class="kw">[</span>self<span class="kw">]</span>::child</span></code></pre></div>
<h4 id="object-properties-affecting-submethod-behavior">Object
Properties Affecting Submethod Behavior</h4>
<h5 id="keepcallerself">keepcallerself</h5>
<p>Controls whether <code>[self]</code> refers to the caller or the
called object in forwarded calls:</p>
<div class="sourceCode" id="cb184"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set keepcallerself</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>::nsf::object::property ::some_obj keepcallerself true</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># When true: the self in called methods is the caller</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="co"># When false: the self in called methods is the invoked object</span></span></code></pre></div>
<h5 id="perobjectdispatch">perobjectdispatch</h5>
<p>Controls whether instance methods are accessible via object-specific
forwarding:</p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set perobjectdispatch</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>::nsf::object::property ::some_obj perobjectdispatch true</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># When true: instance methods are not accessible via object forwarding</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># When false: instance methods are accessible via object forwarding</span></span></code></pre></div>
<h4 id="best-practices-for-submethods">Best Practices for
Submethods</h4>
<ol type="1">
<li>Use submethods to create logical hierarchies of commands</li>
<li>Use the <code>:</code> prefix with <code>-local</code> for calling
private submethods: <code>: -local private_method</code></li>
<li>Be aware of <code>keepcallerself</code> and
<code>perobjectdispatch</code> settings when forwarding methods</li>
<li>Use <code>[current methodpath]</code> to get the full path of the
current method</li>
<li>Leverage error messages to provide information about available
submethods</li>
<li>Use <code>:upvar</code> instead of <code>upvar</code> when accessing
variables across ensemble boundaries</li>
<li>Consider using private submethods as internal helpers to maintain
clean interfaces</li>
<li>Be careful with method names that might conflict with Tcl commands
or ensemble internals</li>
<li>Standardize your ensemble hierarchies for consistency across your
codebase</li>
</ol>
<h4 id="common-pitfalls">Common Pitfalls</h4>
<ol type="1">
<li>Cannot overwrite a simple method with a submethod (or vice
versa)</li>
<li>Submethods are sensitive to protection modifiers (public, private,
protected)</li>
<li>When using <code>next</code> in submethods, be aware of the method
resolution path</li>
<li>Ensure proper handling of arguments when forwarding to
submethods</li>
<li>Regular <code>upvar</code> doesn’t work across ensemble boundaries -
use <code>:upvar</code> instead</li>
<li>Method path reporting in error messages may be confusing at
first</li>
<li><code>keepcallerself</code> without <code>perobjectdispatch</code>
can lead to unexpected behavior</li>
<li>Namespace conflicts between child objects and methods with the same
name</li>
</ol>
<pre><code>
#### Apply Function

The NX/NSF system provides powerful support for the apply function, enabling functional programming patterns:

```tcl
# Register apply as an alias
::nx::Object public alias apply ::apply

::nx::Object create o {
  set :delta 100
  
  :public object method map {lambda values} {
    set result {}
    foreach value $values {
      lappend result [:apply $lambda $value]
    }
    return $result
  }
}

# Usage:
o map {x {return [string length $x]:$x}} {a bb ccc}  # Returns &quot;1:a 2:bb 3:ccc&quot;
o map {x {expr {$x * ${:delta}}}} {1 2 3}  # Returns &quot;100 200 300&quot;</code></pre>
<h4 id="command-resolution-and-namespaces">Command Resolution and
Namespaces</h4>
<p>The NX/NSF system provides sophisticated command resolution
mechanisms, especially when dealing with special characters and
namespaces:</p>
<div class="sourceCode" id="cb187"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define commands with special characters</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> ::nx::@ <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> ::nx::@ <span class="kw">}</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> ::@ <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> ::@ <span class="kw">}</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Resolution in NX context</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> ::o <span class="kw">{</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  :public object method foo <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>    @  # Resolves against ::nx::@ via <span class="kw">interp</span> resolver</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>::o foo  # Returns ::nx::@</span></code></pre></div>
<h5 id="understanding-command-types">Understanding Command Types</h5>
<div class="sourceCode" id="cb188"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> getType <span class="kw">{</span><span class="ot">x</span><span class="kw">}</span> <span class="kw">{dict</span> <span class="ot">get</span> <span class="kw">[</span>::nsf::__db_get_obj @<span class="kw">]</span> <span class="ot">type</span><span class="kw">}</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Types can be empty, cmdName or bytecode depending on context</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>getType @   # May <span class="ot">show</span> <span class="st">&quot;&quot;</span>, <span class="st">&quot;cmdName&quot;</span>, or <span class="st">&quot;bytecode&quot;</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Command resolution transformation</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> origin @  # Converts from bytecode to cmdName</span></code></pre></div>
<h5 id="interpreter-aliases">Interpreter Aliases</h5>
<div class="sourceCode" id="cb189"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> ::@@ <span class="kw">{}</span> <span class="kw">{return</span> ::@@<span class="kw">}</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> ::nx::@ <span class="kw">{}</span> <span class="kw">{return</span> ::nx::@<span class="kw">}</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="kw">interp</span> alias <span class="kw">{}</span> ::nx::@ <span class="kw">{}</span> ::@@</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co"># After aliasing, resolution follows the alias</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>::nx::@  # Returns ::@@</span></code></pre></div>
<h4 id="testing-framework">Testing Framework</h4>
<p>The NX/NSF system includes a powerful testing framework that enables
systematic testing of NX applications and components.</p>
<h5 id="nx-test-case-structure">NX Test Case Structure</h5>
<div class="sourceCode" id="cb190"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>nx::test <span class="kw">case</span> <span class="kw">case</span>-<span class="ot">name</span> <span class="kw">{</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Setup code</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tests with &#39;?&#39; operator</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  ? <span class="kw">{</span>expression<span class="kw">}</span> expected-result</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cleanup code</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h5 id="test-assert-operator">Test Assert Operator</h5>
<p>The <code>?</code> operator evaluates an expression and compares it
against the expected result:</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{set</span> a <span class="dv">5</span><span class="kw">}</span> <span class="dv">5</span>  # Pass</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{expr</span> <span class="kw">{</span><span class="dv">2</span>+<span class="dv">2</span><span class="kw">}}</span> <span class="dv">4</span>  # Pass</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>? <span class="kw">{</span>some-<span class="ot">command</span><span class="kw">}</span> expected-output  # Pass <span class="kw">if</span> output matches</span></code></pre></div>
<h5 id="version-specific-testing">Version-Specific Testing</h5>
<div class="sourceCode" id="cb192"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skip tests if requirement not met</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="kw">{</span>!<span class="kw">[package</span> <span class="ot">vsatisfies</span> <span class="kw">[package</span> req Tcl<span class="kw">]</span> <span class="dv">8</span>.<span class="fl">6.7</span><span class="kw">]}</span> <span class="kw">{return}</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Version-specific test branches</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> tcl87 <span class="kw">[package</span> <span class="ot">vsatisfies</span> <span class="kw">[package</span> req Tcl<span class="kw">]</span> <span class="fl">8.7</span>-<span class="kw">]</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="kw">{</span>!<span class="dt">$::tcl87</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tcl 8.6-specific tests</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h3 id="method-visibility-control">Method Visibility Control</h3>
<p>The NX/NSF system provides mechanisms to control method visibility
and accessibility through <code>export</code> and <code>unexport</code>
features. This section explains their behavior and usage patterns.</p>
<h4 id="key-concepts-1">Key Concepts</h4>
<ol type="1">
<li><strong>Export</strong>
<ul>
<li>Makes methods visible and accessible from outside the
object/class</li>
<li>Adds the PUBLIC_METHOD flag to a method’s C-level
representation</li>
<li>Methods become callable directly on an object without using
self-sends</li>
</ul></li>
<li><strong>Unexport</strong>
<ul>
<li>Makes methods invisible and inaccessible from outside the
object/class</li>
<li>Removes the PUBLIC_METHOD flag from a method’s C-level
representation</li>
<li>Methods become callable only through self-sends (using
<code>my</code> command)</li>
</ul></li>
</ol>
<h4 id="basic-usage-1">Basic Usage</h4>
<div class="sourceCode" id="cb193"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export an object method</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="dt">$object</span> export methodName</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Unexport an object method</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="dt">$object</span> unexport methodName</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Export a class method</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="dt">$class</span> export methodName</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Unexport a class method</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="dt">$class</span> unexport methodName</span></code></pre></div>
<h4 id="export-behaviors">Export Behaviors</h4>
<ol type="1">
<li><p><strong>Exporting Existing Methods</strong></p>
<div class="sourceCode" id="cb194"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object with a protected method</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> o <span class="kw">[</span>nx::Object new<span class="kw">]</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> object method Foo <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> <span class="kw">[</span>::nsf::<span class="ot">current</span> method<span class="kw">]</span> <span class="kw">}</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Method is not accessible directly</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> Foo        # Error: unable to dispatch method</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> <span class="kw">eval</span> <span class="kw">{</span>:Foo<span class="kw">}</span>  # Works: Self-<span class="kw">send</span> succeeds</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co"># After export, method becomes accessible</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> export Foo</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> Foo        # Now works</span></code></pre></div></li>
<li><p><strong>Preemptive Export</strong></p>
<div class="sourceCode" id="cb195"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export a non-existent method</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> export bar</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Still fails because no implementation exists</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> bar        # Error: unable to dispatch method</span></code></pre></div></li>
<li><p><strong>Per-Class Method Export</strong></p>
<div class="sourceCode" id="cb196"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From an instance</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="dt">$instance</span> export methodName  # Makes method accessible on this instance</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># From the class</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="dt">$class</span> export methodName     # Makes method accessible on all instances</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="co"># From a subclass</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="dt">$subclass</span> export methodName  # Makes method accessible on subclass instances</span></code></pre></div></li>
</ol>
<h4 id="unexport-behaviors">Unexport Behaviors</h4>
<ol type="1">
<li><p><strong>Unexporting Existing Methods</strong></p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create object with public method</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> o <span class="kw">[</span>nx::Object new<span class="kw">]</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> public object method foo <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> <span class="kw">[</span>::nsf::<span class="ot">current</span> method<span class="kw">]</span> <span class="kw">}</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Method is accessible</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> foo        # Works</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co"># After unexport, method is protected</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> unexport foo</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> foo        # Error: unable to dispatch method</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="dt">$o</span> <span class="kw">eval</span> <span class="kw">{</span>:foo<span class="kw">}</span>  # Still works through self-<span class="kw">send</span></span></code></pre></div></li>
<li><p><strong>Unexporting Inherited Methods</strong></p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create class with public method</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>Class <span class="ot">create</span> C <span class="kw">{</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  :public method foo <span class="kw">{}</span> <span class="kw">{return</span> ok<span class="kw">}</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create instance</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> c <span class="kw">[</span>C new<span class="kw">]</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="dt">$c</span> foo        # Works</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="co"># After unexport, method is inaccessible</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="dt">$c</span> unexport foo</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="dt">$c</span> foo        # Error: unable to dispatch method</span></code></pre></div></li>
</ol>
<h4 id="advanced-use-cases">Advanced Use Cases</h4>
<ol type="1">
<li><p><strong>Abstract Classes</strong></p>
<div class="sourceCode" id="cb199"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create abstract class by unexporting instance creation methods</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> AbstractQueue <span class="kw">{</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  :method enqueue item <span class="kw">{</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> <span class="st">&quot;not implemented&quot;</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  :method dequeue <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">error</span> <span class="st">&quot;not implemented&quot;</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">class</span> unexport <span class="ot">create</span> new  # Prevent direct instantiation</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Cannot create instances directly</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>AbstractQueue new           # Error: method <span class="kw">unknown</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>AbstractQueue <span class="ot">create</span> aQueue # Error: method <span class="kw">unknown</span></span></code></pre></div></li>
<li><p><strong>Selective Method Exposure</strong></p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>Class <span class="ot">create</span> ChildClass<span class="ot"> -superclass</span> ParentClass <span class="kw">{</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  :export parentProtectedMethod  # Expose inherited protected method</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="common-patterns">Common Patterns</h4>
<ol type="1">
<li><p><strong>Protected Methods by Default</strong></p>
<div class="sourceCode" id="cb201"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>Class <span class="ot">create</span> MyClass <span class="kw">{</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  :method protectedMethod <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> <span class="st">&quot;protected&quot;</span> <span class="kw">}</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  :public method publicMethod <span class="kw">{}</span> <span class="kw">{</span> <span class="kw">return</span> <span class="st">&quot;public&quot;</span> <span class="kw">}</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>Creating Abstract Classes</strong></p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>Class <span class="ot">create</span> AbstractClass <span class="kw">{</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">class</span> unexport new <span class="ot">create</span>  # Prevent direct instantiation</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h3 id="traits">Traits</h3>
<p>Traits provide a mechanism for code reuse in the NX framework,
allowing classes to inherit methods from multiple traits. This is
similar to mixins or interfaces in other languages, but with added
capabilities.</p>
<h4 id="basic-concepts-2">Basic Concepts</h4>
<div class="sourceCode" id="cb203"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a trait</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> &lt;trait_name&gt; <span class="kw">{</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trait definition</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define methods in a trait</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> &lt;trait_name&gt; <span class="kw">{</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    :public method &lt;method_name&gt; <span class="kw">{</span><span class="ot">args</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># method implementation</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify required methods</span></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> &lt;trait_name&gt; <span class="kw">{</span></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    :requiredMethods &lt;method1&gt; &lt;method2&gt; ...</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply traits to classes</span></span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>&lt;class_name&gt; <span class="ot">require</span> trait &lt;trait_name&gt;</span></code></pre></div>
<h4 id="method-resolution">Method Resolution</h4>
<ol type="1">
<li><p>When a class incorporates multiple traits that define the same
method, the method from the last trait applied takes
precedence.</p></li>
<li><p>Original class methods remain unless overridden by a
trait.</p></li>
<li><p>Within trait methods, you can reference the trait using its
name:</p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="kw">return</span> &lt;trait_name&gt;.<span class="kw">[</span><span class="ot">current</span> method<span class="kw">]</span>  # Returns the method <span class="ot">name</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="kw">return</span> &lt;trait_name&gt;.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]</span>  # Returns the full method path</span></code></pre></div></li>
</ol>
<h4 id="code-examples">Code Examples</h4>
<ol type="1">
<li><strong>Basic Trait Creation and Usage</strong></li>
</ol>
<div class="sourceCode" id="cb205"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a trait</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> t1 <span class="kw">{</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    :public method t1m1 <span class="kw">{}</span> <span class="kw">{return</span> t1.<span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>    :public method t1m2 <span class="kw">{}</span> <span class="kw">{return</span> t1.<span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Require the class to implement &quot;foo&quot; method</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>    :requiredMethods foo</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a class with required method</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>nx::Class <span class="ot">create</span> C <span class="kw">{</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>    :public method foo <span class="kw">{}</span> <span class="kw">{return</span> <span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the trait</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> trait t1</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Now class C has methods: foo, t1m1, t1m2</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Method Conflict Resolution</strong></li>
</ol>
<div class="sourceCode" id="cb206"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create multiple traits</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> t2 <span class="kw">{</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>    :public method <span class="st">&quot;bar x&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> t2.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]}</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    :public method <span class="st">&quot;bar y&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> t2.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]}</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> t3 <span class="kw">{</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>    :public method <span class="st">&quot;bar y&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> t3.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]}</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>    :public method <span class="st">&quot;bar z&quot;</span> <span class="kw">{}</span> <span class="kw">{return</span> t3.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]}</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply traits in sequence</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> trait t2</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> trait t3</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Method resolution:</span></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;bar x&quot; comes from t2</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;bar y&quot; comes from t3 (overrides t2&#39;s version)</span></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;bar z&quot; comes from t3</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Trait Dependencies</strong></li>
</ol>
<div class="sourceCode" id="cb207"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create traits with dependencies</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> t1 <span class="kw">{</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    :public method t1m1 <span class="kw">{}</span> <span class="kw">{return</span> t1.<span class="kw">[</span><span class="ot">current</span> method<span class="kw">]}</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    :requiredMethods foo</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>nx::Trait <span class="ot">create</span> t2 <span class="kw">{</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>    :public method foo <span class="kw">{}</span> <span class="kw">{return</span> t2.<span class="kw">[</span><span class="ot">current</span> methodpath<span class="kw">]}</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>    :requiredMethods t1m1  # Requires a method provided by t1</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This will fail if t1 is not applied first:</span></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co"># C require trait t2  # Error: trait t2 requires t1m1</span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct approach:</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> trait t1</span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>C <span class="ot">require</span> trait t2  # Now succeeds</span></code></pre></div>
<h4 id="querying-trait-information">Querying Trait Information</h4>
<div class="sourceCode" id="cb208"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List methods in a class</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="kw">lsort</span> <span class="kw">[</span>C <span class="kw">info</span> methods<span class="kw">]</span>  # Lists all methods</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="kw">lsort</span> <span class="kw">[</span>C <span class="kw">info</span> methods<span class="ot"> -path</span><span class="kw">]</span>  # Lists all methods with full paths</span></code></pre></div>
<h4 id="common-patterns-1">Common Patterns</h4>
<ol type="1">
<li><strong>Required Methods Pattern</strong>: Use
<code>:requiredMethods</code> to enforce an interface contract.</li>
<li><strong>Method Override Pattern</strong>: Apply traits in a specific
order to control which implementations take precedence.</li>
<li><strong>Self-Reference Pattern</strong>: Use
<code>&lt;trait_name&gt;.[current method]</code> to refer to the trait
itself.</li>
</ol>
<h4 id="best-practices-3">Best Practices</h4>
<ol type="1">
<li>Keep traits focused on a single responsibility.</li>
<li>Document required methods clearly.</li>
<li>Be mindful of trait application order when method conflicts
exist.</li>
<li>Use descriptive method names to avoid unintended method
conflicts.</li>
<li>Check for required methods before applying traits to avoid runtime
errors.</li>
</ol>
<h3 id="variable-access-methods">Variable Access Methods</h3>
<p>The NX/NSF system provides comprehensive methods for accessing and
manipulating variables in objects. This section covers the various ways
to work with variables in NX.</p>
<h4 id="basic-variable-access-functions">Basic Variable Access
Functions</h4>
<p>The NX framework provides several functions in the
<code>nsf::var</code> namespace for manipulating variables in
objects:</p>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 41%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
<th>Syntax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>nsf::var::set</code></td>
<td>Get or set a scalar variable</td>
<td><code>nsf::var::set object varName ?value?</code></td>
</tr>
<tr class="even">
<td><code>nsf::var::set -array</code></td>
<td>Get or set an array variable</td>
<td><code>nsf::var::set -array object arrayName ?keyValueList?</code></td>
</tr>
<tr class="odd">
<td><code>nsf::var::exists</code></td>
<td>Check if a scalar variable exists</td>
<td><code>nsf::var::exists object varName</code></td>
</tr>
<tr class="even">
<td><code>nsf::var::exists -array</code></td>
<td>Check if an array variable exists</td>
<td><code>nsf::var::exists -array object arrayName</code></td>
</tr>
<tr class="odd">
<td><code>nsf::var::unset</code></td>
<td>Unset a variable</td>
<td><code>nsf::var::unset object varName</code></td>
</tr>
<tr class="even">
<td><code>nsf::var::unset -nocomplain</code></td>
<td>Unset a variable without error if not exists</td>
<td><code>nsf::var::unset -nocomplain object varName</code></td>
</tr>
<tr class="odd">
<td><code>nsf::var::import</code></td>
<td>Import a variable from an object</td>
<td><code>nsf::var::import object varName</code></td>
</tr>
</tbody>
</table>
<h4 id="alternative-access-methods">Alternative Access Methods</h4>
<p>NX provides alternative ways to access these functions:</p>
<ol type="1">
<li><strong>Namespace Ensemble (<code>::nx::var1</code>)</strong></li>
</ol>
<div class="sourceCode" id="cb209"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="kw">eval</span> ::nx::var1 <span class="kw">{</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">namespace</span> ensemble <span class="ot">create -map</span> <span class="kw">{</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    <span class="ot">exists</span> ::nsf::var::<span class="ot">exists</span> </span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    import ::nsf::var::import </span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span> ::nsf::var::<span class="kw">set</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>::nx::var1 <span class="kw">set</span> object varName ?value?</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>::nx::var1 <span class="ot">exists</span> object varName</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>::nx::var1 import object varName</span></code></pre></div>
<ol start="2" type="1">
<li><strong>NX Object with Aliases
(<code>::nx::var2</code>)</strong></li>
</ol>
<div class="sourceCode" id="cb210"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>::nx::Object <span class="ot">create</span> ::nx::var2 <span class="kw">{</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  :object alias <span class="ot">exists</span> ::nsf::var::<span class="ot">exists</span> </span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  :object alias import ::nsf::var::import</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  :object alias <span class="kw">set</span> ::nsf::var::<span class="kw">set</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage:</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>::nx::var2 <span class="kw">set</span> object varName ?value?</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>::nx::var2 <span class="ot">exists</span> object varName</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>::nx::var2 import object varName</span></code></pre></div>
<h4 id="working-with-scalar-variables">Working with Scalar
Variables</h4>
<div class="sourceCode" id="cb211"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a scalar variable</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="kw">set</span> objectName varName value  # Returns the value</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a scalar variable value</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="kw">set</span> objectName varName        # Returns the <span class="ot">current</span> value</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a scalar variable exists</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="ot">exists</span> objectName varName     # Returns <span class="dv">1</span> <span class="kw">if</span> <span class="ot">exists</span>, <span class="dv">0</span> <span class="kw">if</span> not</span></code></pre></div>
<h4 id="working-with-array-variables">Working with Array Variables</h4>
<div class="sourceCode" id="cb212"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set an array variable</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="kw">set</span><span class="ot"> -array</span> objectName arrayName <span class="kw">{</span>key1 value1 key2 value2<span class="kw">}</span>  # Returns empty <span class="kw">string</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all array elements</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="kw">set</span><span class="ot"> -array</span> objectName arrayName  # Returns <span class="st">&quot;key1 value1 key2 value2...&quot;</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if an array variable exists</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>nsf::var::<span class="ot">exists -array</span> objectName arrayName  # Returns <span class="dv">1</span> <span class="kw">if</span> <span class="ot">exists</span> as <span class="kw">array</span>, <span class="dv">0</span> <span class="kw">if</span> not</span></code></pre></div>
<h4 id="object-variable-access-methods">Object Variable Access
Methods</h4>
<p>Within object methods, you can access object variables in several
ways:</p>
<ol type="1">
<li><strong>Using the colon prefix syntax:</strong></li>
</ol>
<div class="sourceCode" id="cb213"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> :varName value   # Set object <span class="kw">variable</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="kw">incr</span> :varName        # Increment object <span class="kw">variable</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Using <code>eval</code> on another object:</strong></li>
</ol>
<div class="sourceCode" id="cb214"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>otherObject <span class="kw">eval</span> <span class="kw">{incr</span> :varName<span class="kw">}</span>  # Increment varName in otherObject&#39;s context</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Using variable import:</strong></li>
</ol>
<div class="sourceCode" id="cb215"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>::nsf::var::import otherObject varName  # Import from other object</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="kw">incr</span> varName                           # Modify the imported <span class="kw">variable</span></span></code></pre></div>
<h4 id="information-about-object-variables">Information About Object
Variables</h4>
<div class="sourceCode" id="cb216"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all variables in an object</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>objectName <span class="kw">info</span> <span class="ot">vars</span>  # Returns <span class="kw">list</span> of all <span class="kw">variable</span> <span class="ot">names</span> in the object</span></code></pre></div>
<h4 id="performance-considerations">Performance Considerations</h4>
<p>Different variable access methods may have performance implications
when used in high-frequency operations. The test file contains
benchmarks comparing these methods to help optimize your code.</p>
<h3 id="variable-resolution">Variable Resolution</h3>
<p>The NX/NSF system provides sophisticated variable resolution
mechanisms that handle different types of variables and their scoping
rules. This section covers the core concepts and behaviors of variable
resolution in NX.</p>
<h4 id="variable-types-and-notation">Variable Types and Notation</h4>
<p>NX supports several types of variables with distinct notation:</p>
<ul>
<li><p><strong>Instance Variables</strong>: Variables belonging to an
object</p>
<div class="sourceCode" id="cb217"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>:varname  # Colon prefix <span class="kw">for</span> instance variables</span></code></pre></div></li>
<li><p><strong>Global Variables</strong>: Variables in the global
namespace</p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>::varname  # Double colon prefix <span class="kw">for</span> <span class="kw">global</span> variables</span></code></pre></div></li>
<li><p><strong>Namespace Variables</strong>: Variables in object
namespaces</p>
<div class="sourceCode" id="cb219"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="ot">current</span><span class="kw">]</span>::varname  # Fully qualified <span class="kw">namespace</span> <span class="kw">variable</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span>self<span class="kw">]</span>::varname     # Alternative <span class="kw">for</span> <span class="ot">current</span> object&#39;s <span class="kw">namespace</span> variables</span></code></pre></div></li>
</ul>
<h4 id="method-aliases-for-variable-operations">Method Aliases for
Variable Operations</h4>
<p>NX provides method aliases for common Tcl commands to work with
variables in object context:</p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object objeval<span class="ot"> -frame</span> object ::<span class="kw">eval</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object <span class="kw">array</span><span class="ot"> -frame</span> object ::<span class="kw">array</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object <span class="kw">lappend</span><span class="ot"> -frame</span> object ::<span class="kw">lappend</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object <span class="kw">incr</span><span class="ot"> -frame</span> object ::<span class="kw">incr</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object <span class="kw">set</span><span class="ot"> -frame</span> object ::<span class="kw">set</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>::nsf::method::alias ::nx::Object <span class="kw">unset</span><span class="ot"> -frame</span> object ::<span class="kw">unset</span></span></code></pre></div>
<h4 id="object-namespaces">Object Namespaces</h4>
<p>Objects can have associated namespaces for variable management:</p>
<div class="sourceCode" id="cb221"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> o</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">require</span> <span class="kw">namespace</span>  # Create a <span class="kw">namespace</span> <span class="kw">for</span> the object</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check namespace status</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>o <span class="kw">info</span> has <span class="kw">namespace</span>  # Returns <span class="dv">1</span> <span class="kw">if</span> <span class="kw">namespace</span> <span class="ot">is</span> required, <span class="dv">0</span> <span class="kw">if</span> <span class="kw">namespace</span> <span class="ot">exists</span> but wasn&#39;t required</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct namespace access</span></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="kw">eval</span> ::o <span class="kw">{set</span> <span class="ot">x</span> <span class="dv">3</span><span class="kw">}</span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Object variable access (same variable)</span></span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>::o <span class="kw">set</span> <span class="ot">x</span></span></code></pre></div>
<h4 id="evaluation-contexts">Evaluation Contexts</h4>
<p>NX provides several evaluation contexts with different variable
resolution behaviors:</p>
<ol type="1">
<li><p><strong>eval</strong>: Standard evaluation with instance variable
access</p>
<div class="sourceCode" id="cb222"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>o <span class="kw">eval</span> <span class="kw">{set</span> :<span class="ot">x</span> <span class="dv">1</span><span class="kw">}</span>  # Evaluate in object context</span></code></pre></div></li>
<li><p><strong>objeval</strong>: All variables become instance
variables</p>
<div class="sourceCode" id="cb223"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>o objeval <span class="kw">{</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> aaa <span class="dv">1</span>        # Creates instance <span class="kw">variable</span> &#39;aaa&#39;</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> :a <span class="dv">1</span>         # Creates instance <span class="kw">variable</span> &#39;a&#39;</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">global</span> g         # Access <span class="kw">global</span> <span class="kw">variable</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  :<span class="ot">require</span> <span class="kw">namespace</span> # Can <span class="ot">require</span> <span class="kw">namespace</span> within objscoped <span class="kw">frame</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>softeval</strong>: Only variables with colon prefixes
become instance variables</p>
<div class="sourceCode" id="cb224"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>o softeval <span class="kw">{</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> bbb <span class="dv">1</span>        # Local <span class="kw">variable</span>, not an instance <span class="kw">variable</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> :b <span class="dv">1</span>         # Creates instance <span class="kw">variable</span> &#39;b&#39;</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
<li><p><strong>plain eval</strong>: No automatic instance variable
creation</p>
<div class="sourceCode" id="cb225"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>o softeval2 <span class="kw">{</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> zzz <span class="dv">1</span>        # Local <span class="kw">variable</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> :z <span class="dv">1</span>         # Not an instance <span class="kw">variable</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div></li>
</ol>
<h4 id="variable-persistence-and-caching">Variable Persistence and
Caching</h4>
<p>Variables persist between method calls and can be cached for
performance:</p>
<div class="sourceCode" id="cb226"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable caching between method calls</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> o</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>o object method foo <span class="kw">{</span><span class="ot">x</span><span class="kw">}</span> <span class="kw">{set</span> :<span class="ot">y</span> <span class="dv">2</span>; <span class="kw">return</span> <span class="dt">${:x}</span>,<span class="dt">${:y}</span><span class="kw">}</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>o object method bar <span class="kw">{}</span> <span class="kw">{return</span> <span class="dt">${:x}</span>,<span class="dt">${:y}</span><span class="kw">}</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>o <span class="kw">set</span> <span class="ot">x</span> <span class="dv">1</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>o foo <span class="dv">1</span>        # <span class="st">&quot;1,2&quot;</span> - creates var <span class="ot">y</span> and fetches var <span class="ot">x</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>o bar          # <span class="st">&quot;1,2&quot;</span> - fetches two instance variables</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Recreating objects resets variables</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>nx::Object <span class="ot">create</span> o</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>o <span class="kw">set</span> <span class="ot">x</span> <span class="dv">1</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>o bar          # Error - compiled var <span class="ot">y</span> should not exist</span></code></pre></div>
<h4 id="compiled-vs-interpreted-code">Compiled vs Interpreted Code</h4>
<p>NX supports both compiled and interpreted execution with some
behavioral differences:</p>
<ol type="1">
<li><strong>Compiled Code</strong>:
<ul>
<li>Creates link variables for colon-prefixed variables</li>
<li>More efficient for repeated access</li>
<li>Link variables are visible through <code>info vars :*</code></li>
<li>Creates a sorted lookup cache for performance</li>
</ul></li>
<li><strong>Interpreted Code</strong>:
<ul>
<li>Resolves variables on demand</li>
<li>No link variables created</li>
<li>Behavior differs slightly from compiled code</li>
<li>May handle some edge cases differently</li>
</ul></li>
</ol>
<h4 id="best-practices-for-variable-resolution">Best Practices for
Variable Resolution</h4>
<ol type="1">
<li>Use <code>o require namespace</code> when mixing namespace and
object interfaces</li>
<li>Prefer explicit notation for clarity: <code>:var</code> within
methods, <code>o set var</code> externally</li>
<li>Be aware of different behavior in objeval, softeval, and plain
eval</li>
<li>Use <code>::nx::var</code> API for safer external access</li>
<li>Be careful with array elements in variable operations</li>
<li>Consider cached resolution effects with compiled code</li>
<li>Avoid mixing colon-prefixed variable names with
<code>variable</code> and <code>upvar</code> commands</li>
<li>Test both compiled and interpreted execution paths</li>
<li>Be aware of frame context differences when using
<code>uplevel</code> and <code>apply</code></li>
<li>Avoid namespace variables with same names as instance variables</li>
</ol>
<h4 id="common-pitfalls-and-limitations">Common Pitfalls and
Limitations</h4>
<ol type="1">
<li>Mixing <code>variable</code> command with colon-prefixed variables
can lead to unexpected behavior</li>
<li><code>namespace which -variable :X</code> behaves differently than
expected</li>
<li>Colon-prefixed variables with <code>upvar</code> require careful
handling</li>
<li>Variable resolution caches must be refreshed when method definitions
change</li>
<li>Differences between compiled and non-compiled execution can cause
subtle bugs</li>
</ol>
<h2 id="object-lifecycle">Object Lifecycle</h2>
<h3 id="creation">Creation</h3>
<div class="sourceCode" id="cb227"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="dt">$class</span> new ?options? ?<span class="ot">args</span>?                # Create new object</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="dt">$class</span> <span class="ot">create</span> <span class="ot">name</span> ?<span class="ot">args</span>?                 # Create named object</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>::nsf::object::alloc <span class="ot">class</span> ?<span class="ot">name</span>?       # Allocate object</span></code></pre></div>
<h3 id="initialization">Initialization</h3>
<div class="sourceCode" id="cb228"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>:public method init <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>    next                                  # Call parent&#39;s init</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialization code</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h3 id="destruction">Destruction</h3>
<div class="sourceCode" id="cb229"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>:public method <span class="kw">destroy</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cleanup code</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    next                                  # Call parent&#39;s <span class="kw">destroy</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h3 id="volatile-objects">Volatile Objects</h3>
<p>Volatile objects are a powerful feature in NX/XOTcl that provides
automatic memory management. Objects marked as volatile are
automatically destroyed when they go out of scope, making them ideal for
temporary objects and preventing memory leaks.</p>
<h4 id="required-setup">Required Setup</h4>
<div class="sourceCode" id="cb230"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="kw">package</span> <span class="ot">require</span> nx::volatile</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>::nsf::method::<span class="ot">require</span> ::nx::Object volatile</span></code></pre></div>
<h4 id="creating-volatile-objects">Creating Volatile Objects</h4>
<ol type="1">
<li><strong>Named Volatile Objects</strong></li>
</ol>
<div class="sourceCode" id="cb231"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a named volatile NX object</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>Class <span class="ot">create</span> obj1<span class="ot"> -volatile</span> <span class="kw">{</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>    :object method <span class="kw">destroy</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;[self] destroy&quot;</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>        next</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a named volatile XOTcl object</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>XClass <span class="ot">create</span> obj1<span class="ot"> -volatile -proc</span> <span class="kw">destroy</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">puts</span> <span class="st">&quot;[self] destroy&quot;</span></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>    next</span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="2" type="1">
<li><strong>Unnamed Volatile Objects</strong></li>
</ol>
<div class="sourceCode" id="cb232"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an unnamed volatile NX object</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>Class new<span class="ot"> -volatile</span> <span class="kw">{</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    :object method <span class="kw">destroy</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">puts</span> <span class="st">&quot;[self] destroy&quot;</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>        next</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an unnamed volatile XOTcl object</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>XClass new<span class="ot"> -volatile -proc</span> <span class="kw">destroy</span> <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">puts</span> <span class="st">&quot;[self] destroy&quot;</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>    next</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="making-existing-objects-volatile">Making Existing Objects
Volatile</h4>
<p>Objects can be made volatile after creation using the
<code>volatile</code> method:</p>
<div class="sourceCode" id="cb233"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make current object volatile within a method</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>:volatile</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage in a method</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>Class instproc cleanup <span class="kw">{}</span> <span class="kw">{</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    :volatile</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... method body ...</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Object will be destroyed after method completes</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<h4 id="best-practices-4">Best Practices</h4>
<ol type="1">
<li>Use volatile objects for temporary data structures that should be
automatically cleaned up</li>
<li>Always call <code>next</code> in custom destroy methods to ensure
proper cleanup</li>
<li>Test proper destruction using <code>info command</code> checks:</li>
</ol>
<div class="sourceCode" id="cb234"><pre
class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify object destruction</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="kw">{[info</span> <span class="ot">command</span> <span class="dt">$objectName</span><span class="kw">]</span> eq <span class="st">&quot;&quot;</span><span class="kw">}</span> <span class="kw">{</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">puts</span> <span class="st">&quot;Object was properly destroyed&quot;</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<ol start="4" type="1">
<li>Be cautious with volatile objects holding critical resources</li>
<li>Consider using volatile objects in procedures where temporary
objects are needed</li>
</ol>
<h4 id="implementation-notes">Implementation Notes</h4>
<ul>
<li>Volatile objects work with both NX and XOTcl object systems</li>
<li>The volatile flag ensures automatic destruction when objects go out
of scope</li>
<li>Custom destroy methods can be added for cleanup operations</li>
<li>Compatible with other features like mixins and filters</li>
</ul>
<h2 id="method-resolution-1">Method Resolution</h2>
</body>
</html>
